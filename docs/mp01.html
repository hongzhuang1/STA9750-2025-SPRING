<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mini project 01 – STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">mini project 01</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this project, we will use the data from <a href="&quot;https://opendata.cityofnewyork.us/&quot;">NYC Open Data</a>. The data set contains 6,225,611 payroll records and 17 variables, covering payroll information for about 160 agencies in NYC from fiscal years 2014 to 2024. Our goal is to analyze the payroll and evaluate three policy proposals designed to reduce the city’s total payroll expenses. You can find a basic description of the 17 variables in the data set <a href="&quot;https://data.cityofnewyork.us/City-Government/Citywide-Payroll-Data-Fiscal-Year-/k397-673e/about_data&quot;">Here</a>.</p>
<section id="quick-facts" class="level2">
<h2 class="anchored" data-anchor-id="quick-facts">Quick Facts</h2>
<ol type="1">
<li><p>The chairman of the Civil Service Commission in Manhattan has the highest pay rate, with an hourly rate $566.60.</p></li>
<li><p>Combining regular and overtime pay, Daniel E Flynn from the Fire Department had the highest total payroll of $521,235.4 in 2021, having worked 1,820 regular hours and 1564.92 overtime hours.</p></li>
<li><p>William E. Gittens from the Department Of Citywide Admin Services has the most overtime worked, which was 18,564 hours.</p></li>
<li><p>The Office of Collective Bargaining has the highest average total annual payroll per employee, at $96,095.94.</p></li>
<li><p>The Department of Education has the most employees on the payroll each fiscal year.</p></li>
<li><p>The Board of Elections has the highest overtime usage, with total overtime worked accounting for about 20% of the total regular hours.</p></li>
<li><p>Employees who work outside the five boroughs have an average salary of $91,475.31.</p></li>
<li><p>The city’s aggregate payroll has grown by 35.12% over the past ten fiscal years.</p></li>
</ol>
</section>
</section>
<section id="acquire-data-and-import-data-into-r" class="level1">
<h1>Acquire Data and Import Data into R</h1>
<p>Read Data in R</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/STA9750/STA9750-2025-SPRING/data/mp01/nyc_payroll_export.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Load Relevant Packages</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, let’s take a quick look at the payroll data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(nyc_payroll)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6,225,611
Columns: 17
$ fiscal_year                &lt;int&gt; 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2…
$ payroll_number             &lt;int&gt; 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67,…
$ agency_name                &lt;chr&gt; "ADMIN FOR CHILDREN'S SVCS", "ADMIN FOR CHI…
$ last_name                  &lt;chr&gt; "FAYE FALL", "KILGORE", "WISDOM", "MILLER",…
$ first_name                 &lt;chr&gt; "SOKHNA", "ORLANTHA", "CHERISE", "MOYA-GAYE…
$ mid_init                   &lt;chr&gt; "M", "B", "M", "S", "M", "L", "O", NA, "N",…
$ agency_start_date          &lt;chr&gt; "2023-11-20T00:00:00.000", "2023-08-28T00:0…
$ work_location_borough      &lt;chr&gt; "BRONX", "BROOKLYN", "MANHATTAN", "MANHATTA…
$ title_description          &lt;chr&gt; "CHILD PROTECTIVE SPECIALIST", "CHILD PROTE…
$ leave_status_as_of_june_30 &lt;chr&gt; "ACTIVE", "ACTIVE", "ON LEAVE", "ON LEAVE",…
$ base_salary                &lt;dbl&gt; 62043, 62043, 43144, 62043, 60236, 62043, 6…
$ pay_basis                  &lt;chr&gt; "per Annum", "per Annum", "per Annum", "per…
$ regular_hours              &lt;dbl&gt; 1050.00, 1470.00, 1251.50, 1400.75, 700.00,…
$ regular_gross_paid         &lt;dbl&gt; 31267.96, 44660.96, 28649.20, 44515.43, 221…
$ ot_hours                   &lt;dbl&gt; 12.00, 99.75, 30.00, 44.75, 53.00, 146.00, …
$ total_ot_paid              &lt;dbl&gt; 425.00, 3859.84, 802.42, 1476.98, 1933.33, …
$ total_other_pay            &lt;dbl&gt; 78.04, 78.14, 78.26, 78.37, 78.47, 78.86, 7…</code></pre>
</div>
</div>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<section id="conventional-formatting" class="level2">
<h2 class="anchored" data-anchor-id="conventional-formatting">Conventional Formatting</h2>
<ul>
<li>Convert values in some columns to conventional formatting using <code>string_to_title()</code></li>
<li>By using the <code>unique()</code> function in R, we can get a list of distinct values for a variable. I noticed there are some shorthands in the <code>agency_name</code> variable and some agency names need formal formatting.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="ot">&lt;-</span> nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">agency_name =</span> <span class="fu">str_to_title</span>(agency_name),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">last_name =</span> <span class="fu">str_to_title</span>(last_name),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_name =</span> <span class="fu">str_to_title</span>(first_name),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">work_location_borough =</span> <span class="fu">str_to_title</span>(work_location_borough),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_description =</span> <span class="fu">str_to_title</span>(title_description),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">leave_status_as_of_june_30 =</span> <span class="fu">str_to_title</span>(leave_status_as_of_june_30)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="ot">&lt;-</span> nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">agency_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>      agency_name <span class="sc">==</span> <span class="st">"Bronx Da"</span> <span class="sc">~</span> <span class="st">"Bronx District Attorney"</span>,  </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>      agency_name <span class="sc">==</span> <span class="st">"Board Of Correction"</span> <span class="sc">~</span> <span class="st">"Board Of Corrections"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>      agency_name <span class="sc">==</span> <span class="st">"Dept. Of Design &amp; Construction"</span> <span class="sc">~</span> <span class="st">"Dept Of Design &amp; Construction"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>      agency_name <span class="sc">==</span> <span class="st">"Dept. Of Homeless Services"</span> <span class="sc">~</span> <span class="st">"Dept Of Homeless Services"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>      agency_name <span class="sc">==</span> <span class="st">"Office Of Collective Bargainin"</span> <span class="sc">~</span> <span class="st">"Office Of Collective Bargaining"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>      agency_name <span class="sc">==</span> <span class="st">"Board Of Election"</span> <span class="sc">~</span> <span class="st">"Board Of Elections"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      agency_name <span class="sc">==</span> <span class="st">"Doe Custodial Payrol"</span> <span class="sc">~</span> <span class="st">"DOE Custodial Payroll"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> agency_name</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-an-employee-salary-table-for-eric-l.-adams" class="level2">
<h2 class="anchored" data-anchor-id="create-an-employee-salary-table-for-eric-l.-adams">Create an employee salary table for <strong>Eric L. Adams</strong></h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(first_name <span class="sc">==</span> <span class="st">"Eric"</span> <span class="sc">&amp;</span> last_name <span class="sc">==</span> <span class="st">"Adams"</span> <span class="sc">&amp;</span> title_description <span class="sc">==</span> <span class="st">"Mayor"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_salary =</span> regular_gross_paid <span class="sc">+</span> total_ot_paid</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fiscal_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  fiscal_year payroll_number         agency_name last_name first_name mid_init
1        2022              2 Office Of The Mayor     Adams       Eric        L
2        2023              2 Office Of The Mayor     Adams       Eric        L
3        2024              2 Office Of The Mayor     Adams       Eric        L
        agency_start_date work_location_borough title_description
1 2022-01-01T00:00:00.000             Manhattan             Mayor
2 2022-01-01T00:00:00.000             Manhattan             Mayor
3 2022-01-01T00:00:00.000             Manhattan             Mayor
  leave_status_as_of_june_30 base_salary pay_basis regular_hours
1                     Active      258750 per Annum           842
2                     Active      258750 per Annum          1820
3                     Active      258750 per Annum          1820
  regular_gross_paid ot_hours total_ot_paid total_other_pay total_salary
1           120088.4        0             0               0     120088.4
2           258041.2        0             0               0     258041.2
3           257361.2        0             0               0     257361.2</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tbl_txt <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="st">Fiscal Year, Position, Agency, Total Salary</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">2022, Mayor, Office of the Mayor, 120088.4  </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">2023, Mayor, Office of the Mayor, 258041.2</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="st">2023, Mayor, Office of the Mayor, 257361.2</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(tbl_txt) <span class="sc">|&gt;</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Total Salary</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">dollar</span>(<span class="st">`</span><span class="at">Total Salary</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">datatable</span>(<span class="at">options=</span><span class="fu">list</span>(<span class="at">searching=</span><span class="cn">FALSE</span>, </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">paging=</span><span class="cn">FALSE</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">info=</span><span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-e442d3d12659d0500aa0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e442d3d12659d0500aa0">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],[2022,2023,2023],["Mayor","Mayor","Mayor"],["Office of the Mayor","Office of the Mayor","Office of the Mayor"],["$120,088","$258,041","$257,361"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Fiscal Year<\/th>\n      <th>Position<\/th>\n      <th>Agency<\/th>\n      <th>Total Salary<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"paging":false,"info":false,"columnDefs":[{"className":"dt-right","targets":1},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Fiscal Year","targets":1},{"name":"Position","targets":2},{"name":"Agency","targets":3},{"name":"Total Salary","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="analzye-the-distribution-of-base_salary" class="level2">
<h2 class="anchored" data-anchor-id="analzye-the-distribution-of-base_salary">Analzye the distribution of <code>base_salary</code></h2>
<p>In NYC payroll data set, there are three pay types: per annum/prorated annual, per diem and per hour. Let’s first take a look at the distribution of <code>base_salary</code> and determine how to treat any outliers.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"per Annum"</span>, <span class="st">"per Day"</span>, <span class="st">"per Hour"</span>, <span class="st">"Prorated Annual"</span>)){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">subset</span>(nyc_payroll, nyc_payroll<span class="sc">$</span>pay_basis <span class="sc">==</span> i)<span class="sc">$</span>base_salary))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      1   50028   74683   75786   95365  414707 
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.01   33.18   33.18   83.18  110.29  999.95 
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
     0.50      1.00     13.50    810.07     16.52 184931.45 
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2090   26843   33046   35215   39950  184000 </code></pre>
</div>
</div>
<section id="treatment-of-outliers-for-per-annum-employees" class="level3">
<h3 class="anchored" data-anchor-id="treatment-of-outliers-for-per-annum-employees">Treatment of Outliers for Per Annum Employees</h3>
<p>There are some outliers in this category. For example, some observations have a $1 annual rate. After further investigation, I believe these are just not actual payroll records and are immaterial, so I decided no action was needed to handle these values. I applied a 1,820 hours to this group to compute the pay rate.</p>
</section>
<section id="treatment-of-outliers-for-per-hour-employees" class="level3">
<h3 class="anchored" data-anchor-id="treatment-of-outliers-for-per-hour-employees">Treatment of Outliers for Per Hour Employees</h3>
<p>From the output above, it seems unreasonable that the maximum value for an hourly municipal employees was 184,931.45. Upon further investigation, I found that this value comes from the DOE Custodial Payroll, which has only one pay type-an hourly basis. Additionally, half of the records had a per hour rate exceeding $70,000, which suggests the pay is more likely based on an annual salary rather than an hourly rate.</p>
<p>To address the inconsistency between the pay basis and the base salary, I defined a reasonable hourly rate range of $100 for this agency. For observations that fell outside this range, I converted the pay using 1,820 hours to calculate the hourly pay rate.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(agency_name <span class="sc">==</span> <span class="st">"DOE Custodial Payroll"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(base_salary) <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  base_salary    
 Min.   :     1  
 1st Qu.:     1  
 Median : 73774  
 Mean   : 60435  
 3rd Qu.:123636  
 Max.   :184931  </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(agency_name <span class="sc">==</span> <span class="st">"DOE Custodial Payroll"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pay_basis) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  pay_basis
1  per Hour</code></pre>
</div>
</div>
</section>
<section id="treatment-of-outliers-for-per-diem-employees" class="level3">
<h3 class="anchored" data-anchor-id="treatment-of-outliers-for-per-diem-employees">Treatment of Outliers for Per Diem Employees</h3>
<p>Let’s explore the subset with <code>pay_basis == per Day</code>. We can see that half of the sample in this category have a base salary per day of less than $33.18. If we are converting the pay to an hourly rate by applying 7.5 hours, it’s likely that some values of <code>base_salary</code> are not consistent with the <code>pay_basis</code> being “per Day”. To address this, I developed complex rules that take into account both regular hours and base salary, ensuring that the hourly pay falls within a reasonable range. For example, for the group of employees who worked over 650 regular hours and had a third quantile base salary of $380.90, I applied 7.5-hour workday to standardize the calculation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pay_basis <span class="sc">==</span> <span class="st">"per Day"</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"base_salary"</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  base_salary     
 Min.   :   0.01  
 1st Qu.:  33.18  
 Median :  33.18  
 Mean   :  83.18  
 3rd Qu.: 110.29  
 Max.   : 999.95  </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pay_basis <span class="sc">==</span> <span class="st">"per Day"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"regular_hours"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> regular_hours   
 Min.   :-560.0  
 1st Qu.:   0.0  
 Median :   0.0  
 Mean   : 146.5  
 3rd Qu.:   0.0  
 Max.   :2245.7  </code></pre>
</div>
</div>
</section>
</section>
<section id="missing-values" class="level2">
<h2 class="anchored" data-anchor-id="missing-values">Missing Values</h2>
<ul>
<li><p>Be aware that there are over 10,000 missing values in <code>first_name</code> and <code>last_name</code>. Due to confidentiality, some first and last names have been replaced with ‘Xxxx’. For example, approximately 3,541 payroll records in the Police Department having missing names in the data set.</p></li>
<li><p>I decided to exclude these records from the calculations for certain quick-facts related questions later.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(nyc_payroll<span class="sc">$</span>first_name)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(nyc_payroll<span class="sc">$</span>last_name)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(nyc_payroll<span class="sc">$</span>first_name)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14002</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(nyc_payroll<span class="sc">$</span>last_name)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13934</code></pre>
</div>
</div>
</section>
</section>
<section id="feature-engineering" class="level1">
<h1>Feature Engineering</h1>
<ul>
<li><p>After analyzing the distribution of <code>base_salary</code> for each <code>pay_basis</code>, we can create a new variable called <code>pay_rate</code> to make these observations in the data set comparable.</p></li>
<li><p>To calculate the total compensation at the employee level, I would like to create a variable <code>full_name</code> that concatenates <code>first_name</code>, <code>mid_init</code> and <code>last_name</code>. I chose not to include <code>mid_init</code> for records where <code>mid_init</code> is not a letter.</p></li>
<li><p><strong>Caveat</strong>: The new variable <code>full_name</code> is not ideal as a primary key. One obvious drawback is it may not be unique, as some employees can share the same first and last names.</p></li>
<li><p>I chose to create another variable called <code>empl_id</code>, which concatenates <code>full_name</code>, <code>title_description</code>, and <code>agency_start_date</code>. This will improve the accuracy of calculations at the employee level.</p></li>
<li><p>I also created a variable called <code>total_compensation</code>, which shows the total pay, including both regular hours worked and overtime hours.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="ot">&lt;-</span> nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pay_rate =</span> <span class="fu">case_when</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"per Annum"</span>, <span class="st">"Prorated Annual"</span>) <span class="sc">~</span> <span class="fu">round</span>(base_salary<span class="sc">/</span><span class="dv">1820</span>, <span class="dv">2</span>),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Day"</span> <span class="sc">&amp;</span> regular_hours <span class="sc">&gt;=</span> <span class="dv">650</span> <span class="sc">~</span> <span class="fu">round</span>(base_salary<span class="sc">/</span><span class="fl">7.5</span>, <span class="dv">2</span>),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Day"</span> <span class="sc">&amp;</span> regular_hours <span class="sc">&lt;</span> <span class="dv">650</span> <span class="sc">&amp;</span> base_salary <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">~</span> base_salary,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Day"</span> <span class="sc">&amp;</span> regular_hours <span class="sc">&lt;</span> <span class="dv">650</span> <span class="sc">&amp;</span> base_salary <span class="sc">&gt;=</span> <span class="dv">40</span> <span class="sc">&amp;</span> base_salary <span class="sc">&lt;</span> <span class="dv">250</span> <span class="sc">~</span> <span class="fu">round</span>(base_salary<span class="sc">/</span><span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Day"</span> <span class="sc">&amp;</span> regular_hours <span class="sc">&lt;</span> <span class="dv">650</span> <span class="sc">&amp;</span> base_salary <span class="sc">&gt;=</span> <span class="dv">250</span> <span class="sc">&amp;</span> base_salary <span class="sc">&lt;</span> <span class="dv">500</span> <span class="sc">~</span> <span class="fu">round</span>(base_salary<span class="sc">/</span><span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Day"</span> <span class="sc">&amp;</span> regular_hours <span class="sc">&lt;</span> <span class="dv">650</span> <span class="sc">&amp;</span> base_salary <span class="sc">&gt;=</span> <span class="dv">500</span> <span class="sc">~</span> <span class="fu">round</span> (base_salary<span class="sc">/</span><span class="dv">5</span>, <span class="dv">2</span>),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Hour"</span> <span class="sc">&amp;</span> agency_name <span class="sc">!=</span> <span class="st">"DOE Custodial Payroll"</span> <span class="sc">~</span> base_salary,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Hour"</span> <span class="sc">&amp;</span> agency_name <span class="sc">==</span> <span class="st">"DOE Custodial Payroll"</span> <span class="sc">&amp;</span> base_salary <span class="sc">&lt;</span> <span class="dv">100</span> <span class="sc">~</span> base_salary,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Hour"</span> <span class="sc">&amp;</span> agency_name <span class="sc">==</span> <span class="st">"DOE Custodial Payroll"</span> <span class="sc">&amp;</span> base_salary <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">~</span> <span class="fu">round</span>(base_salary<span class="sc">/</span><span class="dv">1820</span>, <span class="dv">2</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_name =</span> <span class="fu">ifelse</span>(</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"^[A-Za-z]$"</span>, mid_init), </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(first_name, mid_init, last_name),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(first_name, last_name)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_compensation =</span> pay_rate <span class="sc">*</span> regular_hours <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> pay_rate <span class="sc">*</span> ot_hours,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">empl_id =</span> <span class="fu">paste</span>(full_name, title_description, agency_start_date, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="some-calculations-related-to-quick-facts" class="level2">
<h2 class="anchored" data-anchor-id="some-calculations-related-to-quick-facts">Some Calculations Related to Quick Facts</h2>
<section id="question-1-which-job-title-has-the-highest-base-rate-of-pay" class="level3">
<h3 class="anchored" data-anchor-id="question-1-which-job-title-has-the-highest-base-rate-of-pay">Question 1: Which job title has the highest base rate of pay?</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(pay_rate, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(agency_name, title_description, pay_rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               agency_name title_description pay_rate
1 Civil Service Commission          Chairman    566.6</code></pre>
</div>
</div>
</section>
<section id="question-2-whcih-individual-in-what-year-had-the-single-highest-city-total-payroll" class="level3">
<h3 class="anchored" data-anchor-id="question-2-whcih-individual-in-what-year-had-the-single-highest-city-total-payroll">Question 2: Whcih individual &amp; in what year had the single highest city total payroll?</h3>
<ul>
<li><p>In question 2 and 3, I filtered the dataset to include only observations with a real name.</p></li>
<li><p>Daniel E Flynn from the Fire Department had the highest total payroll of $572,770.2 in 2021, having worked 2,080 regular hours and 1,564.92 overtime hours.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span> <span class="fu">is.na</span>(first_name) <span class="sc">&amp;</span> <span class="sc">!</span> <span class="fu">is.na</span>(last_name) <span class="sc">&amp;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>           first_name <span class="sc">!=</span> <span class="st">"Xxxx"</span> <span class="sc">&amp;</span> last_name <span class="sc">!=</span> <span class="st">"Xxxx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(total_compensation, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  fiscal_year payroll_number     agency_name last_name first_name mid_init
1        2021             57 Fire Department     Flynn     Daniel        E
        agency_start_date work_location_borough  title_description
1 1999-07-07T00:00:00.000              Brooklyn Chief Fire Marshal
  leave_status_as_of_june_30 base_salary pay_basis regular_hours
1                     Active      235462 per Annum          2080
  regular_gross_paid ot_hours total_ot_paid total_other_pay pay_rate
1           162911.4  1564.92      110078.9         6532.24   129.37
       full_name total_compensation
1 Daniel E Flynn           572770.2
                                                    empl_id
1 Daniel E Flynn_Chief Fire Marshal_1999-07-07T00:00:00.000</code></pre>
</div>
</div>
</section>
<section id="question-3-which-individual-worked-the-most-overtime-hours-in-this-data-set" class="level3">
<h3 class="anchored" data-anchor-id="question-3-which-individual-worked-the-most-overtime-hours-in-this-data-set">Question 3: Which individual worked the most overtime hours in this data set?</h3>
<ul>
<li><p>If we aggregate overtime hours by <code>full_name</code> only, the output may not be meaningful. For example, employees with the full name “Md S Islam” hold 20 different positions in NYC, indicating that the distinct employees share the same full name. To improve accuracy, I decided to group by <code>empl_id</code> instead.</p></li>
<li><p>Based on the output, Willam E Gittens, who works as city custodial assistant had a total of 18,564 overtime hours.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span> <span class="fu">is.na</span>(first_name) <span class="sc">&amp;</span> <span class="sc">!</span> <span class="fu">is.na</span>(last_name) <span class="sc">&amp;</span> first_name <span class="sc">!=</span> <span class="st">"Xxxx"</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">&amp;</span> last_name <span class="sc">!=</span> <span class="st">"Xxxx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(empl_id) <span class="sc">|&gt;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_ot_hours =</span> <span class="fu">sum</span>(ot_hours)) <span class="sc">|&gt;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n_ot_hours, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  empl_id                                                            n_ot_hours
  &lt;chr&gt;                                                                   &lt;dbl&gt;
1 William E Gittens_City Custodial Assistant_2014-04-21T00:00:00.000     18565.</code></pre>
</div>
</div>
</section>
<section id="question-4-which-agency-has-the-highest-average-total-annual-payroll-based-and-overtime-per-employee" class="level3">
<h3 class="anchored" data-anchor-id="question-4-which-agency-has-the-highest-average-total-annual-payroll-based-and-overtime-per-employee">Question 4: Which agency has the highest average total annual payroll (based and overtime per employee)?</h3>
<p>The Office of Collective Bargaining has the highest average total annual payroll per employee $105,584.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fiscal_year, agency_name) <span class="sc">|&gt;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_annual_payroll =</span> <span class="fu">sum</span>(total_compensation) <span class="sc">/</span> <span class="fu">n_distinct</span>(empl_id)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(agency_name) <span class="sc">|&gt;</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_annual_payroll_by_agency =</span> <span class="fu">mean</span>(avg_annual_payroll)) <span class="sc">|&gt;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(avg_annual_payroll_by_agency, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  agency_name                     avg_annual_payroll_by_agency
  &lt;chr&gt;                                                  &lt;dbl&gt;
1 Office Of Collective Bargaining                      105584.</code></pre>
</div>
</div>
</section>
<section id="question-5-which-agency-has-the-most-employees-on-the-payroll-in-each-year" class="level3">
<h3 class="anchored" data-anchor-id="question-5-which-agency-has-the-most-employees-on-the-payroll-in-each-year">Question 5: Which agency has the most employees on the payroll in each year?</h3>
<p>The Department of Education has the most employees on the payroll in each fiscal year.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fiscal_year, agency_name) <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_employees =</span> <span class="fu">n_distinct</span>(empl_id)) <span class="sc">|&gt;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n_employees, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
# Groups:   fiscal_year [11]
   fiscal_year agency_name                    n_employees
         &lt;int&gt; &lt;chr&gt;                                &lt;int&gt;
 1        2014 Dept Of Ed Pedagogical              100583
 2        2015 Dept Of Ed Pedagogical              111851
 3        2016 Dept Of Ed Pedagogical              106256
 4        2017 Dept Of Ed Pedagogical              104624
 5        2018 Dept Of Ed Pedagogical              107952
 6        2019 Dept Of Ed Pedagogical              112064
 7        2020 Dept Of Ed Pedagogical              114994
 8        2021 Dept Of Ed Per Session Teacher      102326
 9        2022 Dept Of Ed Pedagogical              110561
10        2023 Dept Of Ed Pedagogical               57747
11        2024 Dept Of Ed Pedagogical               73509</code></pre>
</div>
</div>
</section>
<section id="question-6-which-agency-has-the-highest-overtime-usage-compared-to-regular-hours" class="level3">
<h3 class="anchored" data-anchor-id="question-6-which-agency-has-the-highest-overtime-usage-compared-to-regular-hours">Question 6: Which agency has the highest overtime usage (compared to regular hours)?</h3>
<p>First, we can calculate the total number of regular and overtime hours.</p>
<p>From the output, we can see that although the Board of Elections doesn’t have the highest overtime hours worked, it has the highest percentage of total overtime relative to total regular hours.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll<span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(agency_name) <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_regular_hours =</span> <span class="fu">sum</span>(regular_hours), </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_ot_hours =</span> <span class="fu">sum</span>(ot_hours), </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ot_pct_of_regular =</span> total_ot_hours<span class="sc">/</span>total_regular_hours</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(ot_pct_of_regular, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  agency_name        total_regular_hours total_ot_hours ot_pct_of_regular
  &lt;chr&gt;                            &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;
1 Board Of Elections           15339960.       3062029.             0.200</code></pre>
</div>
</div>
</section>
<section id="question-7-what-is-the-average-salary-of-employees-who-work-outside-the-five-boroughs" class="level3">
<h3 class="anchored" data-anchor-id="question-7-what-is-the-average-salary-of-employees-who-work-outside-the-five-boroughs">Question 7: What is the average salary of employees who work outside the five boroughs?</h3>
<p>Employees who work outside the the five boroughs have an average salary of $91,475.31.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span> work_location_borough <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Manhattan"</span>, <span class="st">"Brookly"</span>, <span class="st">"Queens"</span>, <span class="st">"Bronx"</span>, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Staten Island"</span>) ) <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_salary =</span> <span class="fu">sum</span>(total_compensation)<span class="sc">/</span> <span class="fu">n_distinct</span>(empl_id)) <span class="sc">|&gt;</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(avg_salary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  avg_salary
1   91475.31</code></pre>
</div>
</div>
</section>
<section id="question-8-how-much-has-the-citys-aggregate-payroll-grown-over-the-past-years" class="level3">
<h3 class="anchored" data-anchor-id="question-8-how-much-has-the-citys-aggregate-payroll-grown-over-the-past-years">Question 8: How much has the city’s aggregate payroll grown over the past years?</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll<span class="sc">|&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fiscal_year) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">aggregate_payroll =</span> <span class="fu">sum</span>(total_compensation)) <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fiscal_year) <span class="sc">|&gt;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">payroll_growth_rate =</span> <span class="fu">last</span>(aggregate_payroll)<span class="sc">/</span><span class="fu">first</span>(aggregate_payroll) <span class="sc">-</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  payroll_growth_rate
                &lt;dbl&gt;
1               0.351</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"The city's aggregate payroll has grown %.2f%% over the past 10 fiscal years."</span> , <span class="fl">0.3511706</span> <span class="sc">*</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The city's aggregate payroll has grown 35.12% over the past 10 fiscal years."</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="policy-analysis" class="level1">
<h1>Policy Analysis</h1>
<section id="capping-salaries-at-mayoral-level" class="level2">
<h2 class="anchored" data-anchor-id="capping-salaries-at-mayoral-level">Capping Salaries at Mayoral Level</h2>
<p>The first policy is to cap salaries at the Mayoral level. It’s worth noting that Mayor Bloomberg’s salary in 2014 was $1, which was an exception. To ensure a fair analysis, I adjusted it to reflect a standard NYC mayor’s pay.</p>
<p>First, I computed the total mayor pay for each fiscal year and used it as a benchmark to identify the employees whose total compensation exceeded the amount in the same fiscal year. From there, I conducted a salary cap analysis.</p>
<p>Based on my analysis, if the salary cap policy had been implemented, it would have saved a total of $92,359,814 over the past ten fiscal years. And the captains from the Fire Department and the Department of Correction would bear the most brunt of the salary cap.</p>
<p>Here is something interesting to note: If we only consider their base salaries, they are actually below the benchmark. However, since 2015, they have worked an average of 1,300 overtime hours per year, which led to their total compensation exceeding the Mayor’s level. Next, I will explore the impact of reducing the overtime hours by increasing full-time employment.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>benchmark <span class="ot">&lt;-</span> nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(title_description <span class="sc">==</span> <span class="st">"Mayor"</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fiscal_year) <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_mayor_pay =</span> <span class="fu">sum</span>(<span class="fu">case_when</span>(</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    fiscal_year <span class="sc">==</span> <span class="dv">2014</span> <span class="sc">~</span> <span class="dv">2</span> <span class="sc">*</span> total_compensation,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> total_compensation)) </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="ot">&lt;-</span> nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(benchmark, <span class="at">by =</span> <span class="st">"fiscal_year"</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">salary_cap =</span> total_mayor_pay) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_above_the_cap =</span> <span class="fu">ifelse</span>(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>      total_compensation <span class="sc">&gt;</span> salary_cap, <span class="st">"Yes"</span>, <span class="st">"No"</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pay_savings_from_cap =</span> <span class="fu">ifelse</span>(</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>      is_above_the_cap <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="fu">round</span>(total_compensation <span class="sc">-</span> salary_cap, <span class="dv">2</span>), <span class="dv">0</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(nyc_payroll<span class="sc">$</span>pay_savings_from_cap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 92359814</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_above_the_cap <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(agency_name, title_description) <span class="sc">|&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_savings =</span> <span class="fu">sum</span>(pay_savings_from_cap)) <span class="sc">|&gt;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_savings))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 320 × 3
# Groups:   agency_name [63]
   agency_name                   title_description                 total_savings
   &lt;chr&gt;                         &lt;chr&gt;                                     &lt;dbl&gt;
 1 Department Of Correction      Captain                               13433166.
 2 Fire Department               Captain                                9358013.
 3 Department Of Correction      Warden-Assistant Deputy Warden T…      6921116.
 4 Department Of Correction      Correction Officer                     4806111.
 5 Police Department             Police Officer D/A Detective 1st…      3776059.
 6 Police Department             Lieutenant D/A Commander Of Dete…      3412895.
 7 Police Department             Captain Detailed As Assistant Ch…      2850212.
 8 Police Department             Lieutenant D/A Special Assignment      2731127.
 9 Department Of Correction      Senior Stationary Engineer             2522180.
10 Dept Of Health/Mental Hygiene City Medical Examiner                  2513273.
# ℹ 310 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_above_the_cap <span class="sc">==</span> <span class="st">"Yes"</span>, agency_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Department Of Correction"</span>, <span class="st">"Fire Department"</span>), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>         title_description <span class="sc">==</span> <span class="st">"Captain"</span>) <span class="sc">|&gt;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fiscal_year) <span class="sc">|&gt;</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(ot_hours))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  fiscal_year `mean(ot_hours)`
        &lt;int&gt;            &lt;dbl&gt;
1        2015            1429.
2        2016            1525.
3        2017            1435.
4        2018            1612.
5        2020            1550.
6        2021            1418.
7        2022            1444.
8        2023            1302.
9        2024            1154.</code></pre>
</div>
</div>
</section>
<section id="increasing-staffing-to-reduce-overtime-expenses" class="level2">
<h2 class="anchored" data-anchor-id="increasing-staffing-to-reduce-overtime-expenses">Increasing Staffing to Reduce Overtime Expenses</h2>
<p>Now, I wanted to explore the the impact and savings by increasing staffing to reduce overtime hours. First, I aggregated the total overtime hours for each combination of agency and job title and calculated the number of full-time employee equivalents using a standard of 1,820 hours per full-time employee. Using the average pay rate for each combination of agency and position, I then computed the potential full-time salary if overtime hours were replaced by equivalent full-time positions.</p>
<p>From my analysis, we can see that replacing overtime hours with full-time employees would have resulted in total savings of $8,293,349,444 over the past ten fiscal years. This policy proves to be more effective in generating savings than the salary cap.</p>
<p>As previously mentioned, there are actually very few municipal employees whose base salaries exceed the Mayor’s salary. The main reason their total compensation surpasses this level is the significant amount of overtime worked.</p>
<p>In addition, we can see that a 50% savings can be achieved from increasing the number of full-time employees to reduce overtime hours, particularly in the Police Department and the Fire Department.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>overtime_replacement <span class="ot">&lt;-</span> nyc_payroll <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agency_role =</span> <span class="fu">paste</span>(agency_name, title_description, <span class="at">sep =</span> <span class="st">"_"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fiscal_year, agency_role) <span class="sc">|&gt;</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_pay_rate =</span> <span class="fu">mean</span>(pay_rate), <span class="at">total_ot_worked =</span> <span class="fu">sum</span>(ot_hours)) <span class="sc">|&gt;</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(total_ot_worked <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_time_equivalent =</span> <span class="fu">round</span>(total_ot_worked<span class="sc">/</span><span class="dv">1820</span>, <span class="dv">6</span>),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_time_pay =</span> <span class="fu">round</span>(avg_pay_rate <span class="sc">*</span> full_time_equivalent <span class="sc">*</span> <span class="dv">1820</span>, <span class="dv">2</span>),</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ot_reduction_savings =</span> total_ot_worked <span class="sc">*</span> <span class="fl">1.5</span> <span class="sc">*</span> avg_pay_rate <span class="sc">-</span> full_time_pay,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">agency =</span> <span class="fu">str_extract</span>(agency_role, <span class="st">"^[^_]+"</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_savings =</span> <span class="fu">sum</span>(ot_reduction_savings),</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">savings_pct_of_total =</span> ot_reduction_savings<span class="sc">/</span>total_savings</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>overtime_replacement <span class="sc">|&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(agency) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_savings_pct_by_agency =</span> <span class="fu">round</span>(<span class="fu">sum</span>(savings_pct_of_total), <span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_savings_pct_by_agency))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 93 × 2
   agency                         total_savings_pct_by_agency
   &lt;chr&gt;                                                &lt;dbl&gt;
 1 Police Department                                   0.383 
 2 Fire Department                                     0.190 
 3 Department Of Correction                            0.112 
 4 Department Of Sanitation                            0.0799
 5 Nyc Housing Authority                               0.0566
 6 Department Of Transportation                        0.0321
 7 Dept Of Environment Protection                      0.0249
 8 Hra/Dept Of Social Services                         0.0246
 9 Admin For Children's Svcs                           0.0208
10 Dept Of Citywide Admin Svcs                         0.0120
# ℹ 83 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(overtime_replacement<span class="sc">$</span>ot_reduction_savings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8293349444</code></pre>
</div>
</div>
</section>
<section id="create-your-own-policy-proposal" class="level2">
<h2 class="anchored" data-anchor-id="create-your-own-policy-proposal">Create Your Own Policy Proposal</h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/hongzhuang1\.github\.io\/STA9750-2025-SPRING\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>