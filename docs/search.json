[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "About Me",
    "section": "",
    "text": "My name is Hong Zhuang. This is my first semester in the QMM program at Baruch College. I graduated with a Bachelor degree in Business Administration from Baruch College and a Master’s degree in Science from CUNY, City College.\nCurrently, I’m working as a staff accountant at a retail start-up. I am committed to become a risk analyst at a financial institution. I have passed CFA Level1, Level2 and FRM Level1. If you share the same career path, feel free to connect with me on LinkedIn.\n\n\n\n\n\n\n\nLast Updated: Sunday 02 09, 2025 at 22:31PM"
  },
  {
    "objectID": "mini_project01.html",
    "href": "mini_project01.html",
    "title": "mini project 01",
    "section": "",
    "text": "In this project, we will use the dataset from NYC Open Data. Our goal is to analyze the city’s payroll data and the three policy proposals designed to reduce the city’s total payroll expenses.Basic description of each column in the data set can be found data page\n\n\n\n\n\nRead data into R\n\ndata &lt;- read.csv(\"~/STA9750/STA9750-2025-SPRING/data/mp01/nyc_payroll_export.csv\")\n\nNow, let’s take a quick look of the first several rows of the payroll data.\n\nlibrary(dplyr)\nglimpse(data)\n\nRows: 6,225,611\nColumns: 17\n$ fiscal_year                &lt;int&gt; 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2…\n$ payroll_number             &lt;int&gt; 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67,…\n$ agency_name                &lt;chr&gt; \"ADMIN FOR CHILDREN'S SVCS\", \"ADMIN FOR CHI…\n$ last_name                  &lt;chr&gt; \"FAYE FALL\", \"KILGORE\", \"WISDOM\", \"MILLER\",…\n$ first_name                 &lt;chr&gt; \"SOKHNA\", \"ORLANTHA\", \"CHERISE\", \"MOYA-GAYE…\n$ mid_init                   &lt;chr&gt; \"M\", \"B\", \"M\", \"S\", \"M\", \"L\", \"O\", NA, \"N\",…\n$ agency_start_date          &lt;chr&gt; \"2023-11-20T00:00:00.000\", \"2023-08-28T00:0…\n$ work_location_borough      &lt;chr&gt; \"BRONX\", \"BROOKLYN\", \"MANHATTAN\", \"MANHATTA…\n$ title_description          &lt;chr&gt; \"CHILD PROTECTIVE SPECIALIST\", \"CHILD PROTE…\n$ leave_status_as_of_june_30 &lt;chr&gt; \"ACTIVE\", \"ACTIVE\", \"ON LEAVE\", \"ON LEAVE\",…\n$ base_salary                &lt;dbl&gt; 62043, 62043, 43144, 62043, 60236, 62043, 6…\n$ pay_basis                  &lt;chr&gt; \"per Annum\", \"per Annum\", \"per Annum\", \"per…\n$ regular_hours              &lt;dbl&gt; 1050.00, 1470.00, 1251.50, 1400.75, 700.00,…\n$ regular_gross_paid         &lt;dbl&gt; 31267.96, 44660.96, 28649.20, 44515.43, 221…\n$ ot_hours                   &lt;dbl&gt; 12.00, 99.75, 30.00, 44.75, 53.00, 146.00, …\n$ total_ot_paid              &lt;dbl&gt; 425.00, 3859.84, 802.42, 1476.98, 1933.33, …\n$ total_other_pay            &lt;dbl&gt; 78.04, 78.14, 78.26, 78.37, 78.47, 78.86, 7…\n\n\nAlso, we can take a look at each columns\n\nsummary(data)\n\n  fiscal_year   payroll_number    agency_name         last_name        \n Min.   :2014   Min.   :  2.0     Length:6225611     Length:6225611    \n 1st Qu.:2016   1st Qu.:300.0     Class :character   Class :character  \n Median :2019   Median :742.0     Mode  :character   Mode  :character  \n Mean   :2019   Mean   :573.8                                          \n 3rd Qu.:2022   3rd Qu.:747.0                                          \n Max.   :2024   Max.   :996.0                                          \n                NA's   :1745440                                        \n  first_name          mid_init         agency_start_date  work_location_borough\n Length:6225611     Length:6225611     Length:6225611     Length:6225611       \n Class :character   Class :character   Class :character   Class :character     \n Mode  :character   Mode  :character   Mode  :character   Mode  :character     \n                                                                               \n                                                                               \n                                                                               \n                                                                               \n title_description  leave_status_as_of_june_30  base_salary      \n Length:6225611     Length:6225611             Min.   :     0.0  \n Class :character   Class :character           1st Qu.:    33.2  \n Mode  :character   Mode  :character           Median : 43903.0  \n                                               Mean   : 45659.1  \n                                               3rd Qu.: 81186.0  \n                                               Max.   :414707.0  \n                                                                 \n  pay_basis         regular_hours     regular_gross_paid    ot_hours     \n Length:6225611     Min.   :-2240.0   Min.   :-205452    Min.   :-209.0  \n Class :character   1st Qu.:    0.0   1st Qu.:   3237    1st Qu.:   0.0  \n Mode  :character   Median :    0.0   Median :  35728    Median :   0.0  \n                    Mean   :  657.5   Mean   :  43170    Mean   :  65.2  \n                    3rd Qu.: 1820.0   3rd Qu.:  75766    3rd Qu.:   0.0  \n                    Max.   : 6666.0   Max.   : 684970    Max.   :3692.9  \n                                                                         \n total_ot_paid      total_other_pay    \n Min.   :-26493.9   Min.   :-281595.0  \n 1st Qu.:     0.0   1st Qu.:      0.0  \n Median :     0.0   Median :     94.2  \n Mean   :  3647.7   Mean   :   3219.1  \n 3rd Qu.:   121.9   3rd Qu.:   4133.7  \n Max.   :527532.0   Max.   : 714664.3  \n                                       \n\n\n\n\n\nHere, some formatting is needed for readability. * Convert these columns for conventional formatting *\nAfter some formatting was done, here is how the data looks like in a table."
  },
  {
    "objectID": "mini_project01.html#data",
    "href": "mini_project01.html#data",
    "title": "mini project 01",
    "section": "",
    "text": "Read data into R\n\ndata &lt;- read.csv(\"~/STA9750/STA9750-2025-SPRING/data/mp01/nyc_payroll_export.csv\")\n\nNow, let’s take a quick look of the first several rows of the payroll data.\n\nlibrary(dplyr)\nglimpse(data)\n\nRows: 6,225,611\nColumns: 17\n$ fiscal_year                &lt;int&gt; 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2…\n$ payroll_number             &lt;int&gt; 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67,…\n$ agency_name                &lt;chr&gt; \"ADMIN FOR CHILDREN'S SVCS\", \"ADMIN FOR CHI…\n$ last_name                  &lt;chr&gt; \"FAYE FALL\", \"KILGORE\", \"WISDOM\", \"MILLER\",…\n$ first_name                 &lt;chr&gt; \"SOKHNA\", \"ORLANTHA\", \"CHERISE\", \"MOYA-GAYE…\n$ mid_init                   &lt;chr&gt; \"M\", \"B\", \"M\", \"S\", \"M\", \"L\", \"O\", NA, \"N\",…\n$ agency_start_date          &lt;chr&gt; \"2023-11-20T00:00:00.000\", \"2023-08-28T00:0…\n$ work_location_borough      &lt;chr&gt; \"BRONX\", \"BROOKLYN\", \"MANHATTAN\", \"MANHATTA…\n$ title_description          &lt;chr&gt; \"CHILD PROTECTIVE SPECIALIST\", \"CHILD PROTE…\n$ leave_status_as_of_june_30 &lt;chr&gt; \"ACTIVE\", \"ACTIVE\", \"ON LEAVE\", \"ON LEAVE\",…\n$ base_salary                &lt;dbl&gt; 62043, 62043, 43144, 62043, 60236, 62043, 6…\n$ pay_basis                  &lt;chr&gt; \"per Annum\", \"per Annum\", \"per Annum\", \"per…\n$ regular_hours              &lt;dbl&gt; 1050.00, 1470.00, 1251.50, 1400.75, 700.00,…\n$ regular_gross_paid         &lt;dbl&gt; 31267.96, 44660.96, 28649.20, 44515.43, 221…\n$ ot_hours                   &lt;dbl&gt; 12.00, 99.75, 30.00, 44.75, 53.00, 146.00, …\n$ total_ot_paid              &lt;dbl&gt; 425.00, 3859.84, 802.42, 1476.98, 1933.33, …\n$ total_other_pay            &lt;dbl&gt; 78.04, 78.14, 78.26, 78.37, 78.47, 78.86, 7…\n\n\nAlso, we can take a look at each columns\n\nsummary(data)\n\n  fiscal_year   payroll_number    agency_name         last_name        \n Min.   :2014   Min.   :  2.0     Length:6225611     Length:6225611    \n 1st Qu.:2016   1st Qu.:300.0     Class :character   Class :character  \n Median :2019   Median :742.0     Mode  :character   Mode  :character  \n Mean   :2019   Mean   :573.8                                          \n 3rd Qu.:2022   3rd Qu.:747.0                                          \n Max.   :2024   Max.   :996.0                                          \n                NA's   :1745440                                        \n  first_name          mid_init         agency_start_date  work_location_borough\n Length:6225611     Length:6225611     Length:6225611     Length:6225611       \n Class :character   Class :character   Class :character   Class :character     \n Mode  :character   Mode  :character   Mode  :character   Mode  :character     \n                                                                               \n                                                                               \n                                                                               \n                                                                               \n title_description  leave_status_as_of_june_30  base_salary      \n Length:6225611     Length:6225611             Min.   :     0.0  \n Class :character   Class :character           1st Qu.:    33.2  \n Mode  :character   Mode  :character           Median : 43903.0  \n                                               Mean   : 45659.1  \n                                               3rd Qu.: 81186.0  \n                                               Max.   :414707.0  \n                                                                 \n  pay_basis         regular_hours     regular_gross_paid    ot_hours     \n Length:6225611     Min.   :-2240.0   Min.   :-205452    Min.   :-209.0  \n Class :character   1st Qu.:    0.0   1st Qu.:   3237    1st Qu.:   0.0  \n Mode  :character   Median :    0.0   Median :  35728    Median :   0.0  \n                    Mean   :  657.5   Mean   :  43170    Mean   :  65.2  \n                    3rd Qu.: 1820.0   3rd Qu.:  75766    3rd Qu.:   0.0  \n                    Max.   : 6666.0   Max.   : 684970    Max.   :3692.9  \n                                                                         \n total_ot_paid      total_other_pay    \n Min.   :-26493.9   Min.   :-281595.0  \n 1st Qu.:     0.0   1st Qu.:      0.0  \n Median :     0.0   Median :     94.2  \n Mean   :  3647.7   Mean   :   3219.1  \n 3rd Qu.:   121.9   3rd Qu.:   4133.7  \n Max.   :527532.0   Max.   : 714664.3"
  },
  {
    "objectID": "mini_project01.html#some-formatting",
    "href": "mini_project01.html#some-formatting",
    "title": "mini project 01",
    "section": "",
    "text": "Here, some formatting is needed for readability. * Convert these columns for conventional formatting *\nAfter some formatting was done, here is how the data looks like in a table."
  },
  {
    "objectID": "mp01.html",
    "href": "mp01.html",
    "title": "NYC Payroll Expenses Reduction Proposal",
    "section": "",
    "text": "Managing payroll expenses is a critical component of maintaining the financial health of New York City. With a vast workforce spanning over 160 city agencies, payroll represents a significant portion of the city’s budget. This project aims to assess payroll expenditures and explore strategic measures to enhance cost efficiency. By analyzing historical payroll trends and evaluating targeted policy proposals, we seek to identify opportunities for substantial cost reductions while maintaining essential public services.\n\n\n\nHighest Pay Rate: The chairman of the Civil Service Commission in Manhattan has the highest pay rate, with an hourly rate $566.60.\nHighest Total Payroll: Combining regular and overtime pay, Daniel E Flynn from the Fire Department had the highest total payroll of $521,235.4 in 2021, having worked 1,820 regular hours and 1564.92 overtime hours.\nMost Overtime Worked: William E. Gittens from the Department Of Citywide Admin Services has the most overtime worked, which was 18,564 hours.\nHighest Average Total Annual Payroll Per Employee: The Office of Collective Bargaining has the highest average total annual payrollper employee, at $96,095.94.\nMost Employees on Payroll: The Department of Education has the most employees on the payroll each fiscal year.\nHighest Overtime Usage: The Board of Elections has the highest overtime usage, with total overtime worked accounting for about 20% of the total regular hours.\nAverage Salary for Employees Outside the Five Boroughs: Employees who work outside the five boroughs have an average salary of $91,475.31.\nAggregate Payroll Growth: The city’s aggregate payroll has grown by 35.12% over the past ten fiscal years."
  },
  {
    "objectID": "mp01.html#data",
    "href": "mp01.html#data",
    "title": "mini project 01",
    "section": "",
    "text": "Read data into R\nLoad relevant packages\nNow, let’s take a quick look of the first several rows of the payroll data.\n\nglimpse(data)\n\nRows: 6,225,611\nColumns: 17\n$ fiscal_year                &lt;int&gt; 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2…\n$ payroll_number             &lt;int&gt; 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67,…\n$ agency_name                &lt;chr&gt; \"ADMIN FOR CHILDREN'S SVCS\", \"ADMIN FOR CHI…\n$ last_name                  &lt;chr&gt; \"FAYE FALL\", \"KILGORE\", \"WISDOM\", \"MILLER\",…\n$ first_name                 &lt;chr&gt; \"SOKHNA\", \"ORLANTHA\", \"CHERISE\", \"MOYA-GAYE…\n$ mid_init                   &lt;chr&gt; \"M\", \"B\", \"M\", \"S\", \"M\", \"L\", \"O\", NA, \"N\",…\n$ agency_start_date          &lt;chr&gt; \"2023-11-20T00:00:00.000\", \"2023-08-28T00:0…\n$ work_location_borough      &lt;chr&gt; \"BRONX\", \"BROOKLYN\", \"MANHATTAN\", \"MANHATTA…\n$ title_description          &lt;chr&gt; \"CHILD PROTECTIVE SPECIALIST\", \"CHILD PROTE…\n$ leave_status_as_of_june_30 &lt;chr&gt; \"ACTIVE\", \"ACTIVE\", \"ON LEAVE\", \"ON LEAVE\",…\n$ base_salary                &lt;dbl&gt; 62043, 62043, 43144, 62043, 60236, 62043, 6…\n$ pay_basis                  &lt;chr&gt; \"per Annum\", \"per Annum\", \"per Annum\", \"per…\n$ regular_hours              &lt;dbl&gt; 1050.00, 1470.00, 1251.50, 1400.75, 700.00,…\n$ regular_gross_paid         &lt;dbl&gt; 31267.96, 44660.96, 28649.20, 44515.43, 221…\n$ ot_hours                   &lt;dbl&gt; 12.00, 99.75, 30.00, 44.75, 53.00, 146.00, …\n$ total_ot_paid              &lt;dbl&gt; 425.00, 3859.84, 802.42, 1476.98, 1933.33, …\n$ total_other_pay            &lt;dbl&gt; 78.04, 78.14, 78.26, 78.37, 78.47, 78.86, 7…\n\nhead(data, 5)\n\n  fiscal_year payroll_number               agency_name last_name first_name\n1        2024             67 ADMIN FOR CHILDREN'S SVCS FAYE FALL     SOKHNA\n2        2024             67 ADMIN FOR CHILDREN'S SVCS   KILGORE   ORLANTHA\n3        2024             67 ADMIN FOR CHILDREN'S SVCS    WISDOM    CHERISE\n4        2024             67 ADMIN FOR CHILDREN'S SVCS    MILLER  MOYA-GAYE\n5        2024             67 ADMIN FOR CHILDREN'S SVCS   BRADLEY    YASHIKA\n  mid_init       agency_start_date work_location_borough\n1        M 2023-11-20T00:00:00.000                 BRONX\n2        B 2023-08-28T00:00:00.000              BROOKLYN\n3        M 2022-10-24T00:00:00.000             MANHATTAN\n4        S 2023-02-27T00:00:00.000             MANHATTAN\n5        M 2023-02-27T00:00:00.000                 BRONX\n            title_description leave_status_as_of_june_30 base_salary pay_basis\n1 CHILD PROTECTIVE SPECIALIST                     ACTIVE       62043 per Annum\n2 CHILD PROTECTIVE SPECIALIST                     ACTIVE       62043 per Annum\n3         COMMUNITY ASSOCIATE                   ON LEAVE       43144 per Annum\n4 CHILD PROTECTIVE SPECIALIST                   ON LEAVE       62043 per Annum\n5 CHILD PROTECTIVE SPECIALIST                     CEASED       60236 per Annum\n  regular_hours regular_gross_paid ot_hours total_ot_paid total_other_pay\n1       1050.00           31267.96    12.00        425.00           78.04\n2       1470.00           44660.96    99.75       3859.84           78.14\n3       1251.50           28649.20    30.00        802.42           78.26\n4       1400.75           44515.43    44.75       1476.98           78.37\n5        700.00           22133.64    53.00       1933.33           78.47"
  },
  {
    "objectID": "mp01.html#some-formatting",
    "href": "mp01.html#some-formatting",
    "title": "mini project 01",
    "section": "",
    "text": "Here, some formatting is needed for readability. * Convert these columns for conventional formatting *\n\ndata &lt;- data %&gt;%\n  mutate(\n    agency_name = str_to_title(agency_name),\n    last_name = str_to_title(last_name),\n    first_name = str_to_title(first_name),\n    work_location_borough = str_to_title(work_location_borough),\n    title_description = str_to_title(title_description),\n    leave_status_as_of_june_30 = str_to_title(leave_status_as_of_june_30)\n  )"
  },
  {
    "objectID": "mp01.html#some-calculations-related-to-quick-facts",
    "href": "mp01.html#some-calculations-related-to-quick-facts",
    "title": "mini project 01",
    "section": "Some Calculations Related to Quick Facts",
    "text": "Some Calculations Related to Quick Facts\n\nQuestion 1: Which job title has the highest base rate of pay?\n\n\nCode\nnyc_payroll |&gt;\n  slice_max(pay_rate, n = 1) |&gt;\n  select(agency_name, title_description, pay_rate)\n\n\n               agency_name title_description pay_rate\n1 Civil Service Commission          Chairman    566.6\n\n\n\n\nQuestion 2: Whcih individual & in what year had the single highest city total payroll?\n\nIn question 2 and 3, I filtered the dataset to include only observations with a real name.\nDaniel E Flynn from the Fire Department had the highest total payroll of $572,770.2 in 2021, having worked 2,080 regular hours and 1,564.92 overtime hours.\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(! is.na(first_name) & ! is.na(last_name) & \n           first_name != \"Xxxx\" & last_name != \"Xxxx\") |&gt;\n  slice_max(total_compensation, n = 1)\n\n\n  fiscal_year payroll_number     agency_name last_name first_name mid_init\n1        2021             57 Fire Department     Flynn     Daniel        E\n        agency_start_date work_location_borough  title_description\n1 1999-07-07T00:00:00.000              Brooklyn Chief Fire Marshal\n  leave_status_as_of_june_30 base_salary pay_basis regular_hours\n1                     Active      235462 per Annum          2080\n  regular_gross_paid ot_hours total_ot_paid total_other_pay pay_rate\n1           162911.4  1564.92      110078.9         6532.24   129.37\n       full_name total_compensation\n1 Daniel E Flynn           572770.2\n                                                    empl_id\n1 Daniel E Flynn_Chief Fire Marshal_1999-07-07T00:00:00.000\n\n\n\n\nQuestion 3: Which individual worked the most overtime hours in this data set?\n\nIf we aggregate overtime hours by full_name only, the output may not be meaningful. For example, employees with the full name “Md S Islam” hold 20 different positions in NYC, indicating that the distinct employees share the same full name. To improve accuracy, I decided to group by empl_id instead.\nBased on the output, Willam E Gittens, who works as city custodial assistant had a total of 18,564 overtime hours.\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(! is.na(first_name) & ! is.na(last_name) & first_name != \"Xxxx\" \n         & last_name != \"Xxxx\") |&gt;\n  group_by(empl_id) |&gt;\n  summarize(n_ot_hours = sum(ot_hours)) |&gt;\n  slice_max(n_ot_hours, n = 1)\n\n\n# A tibble: 1 × 2\n  empl_id                                                            n_ot_hours\n  &lt;chr&gt;                                                                   &lt;dbl&gt;\n1 William E Gittens_City Custodial Assistant_2014-04-21T00:00:00.000     18565.\n\n\n\n\nQuestion 4: Which agency has the highest average total annual payroll (based and overtime per employee)?\nThe Office of Collective Bargaining has the highest average total annual payroll per employee $105,584.\n\n\nCode\nnyc_payroll |&gt;\n  group_by(fiscal_year, agency_name) |&gt;\n  summarize(\n    avg_annual_payroll = sum(total_compensation) / n_distinct(empl_id)\n    ) |&gt;\n  group_by(agency_name) |&gt;\n  summarize(avg_annual_payroll_by_agency = mean(avg_annual_payroll)) |&gt;\n  slice_max(avg_annual_payroll_by_agency, n = 1)\n\n\n# A tibble: 1 × 2\n  agency_name                     avg_annual_payroll_by_agency\n  &lt;chr&gt;                                                  &lt;dbl&gt;\n1 Office Of Collective Bargaining                      105584.\n\n\n\n\nQuestion 5: Which agency has the most employees on the payroll in each year?\nThe Department of Education has the most employees on the payroll in each fiscal year.\n\n\nCode\nnyc_payroll |&gt;\n  group_by(fiscal_year, agency_name) |&gt;\n  summarize(n_employees = n_distinct(empl_id)) |&gt;\n  slice_max(n_employees, n = 1)\n\n\n# A tibble: 11 × 3\n# Groups:   fiscal_year [11]\n   fiscal_year agency_name                    n_employees\n         &lt;int&gt; &lt;chr&gt;                                &lt;int&gt;\n 1        2014 Dept Of Ed Pedagogical              100583\n 2        2015 Dept Of Ed Pedagogical              111851\n 3        2016 Dept Of Ed Pedagogical              106256\n 4        2017 Dept Of Ed Pedagogical              104624\n 5        2018 Dept Of Ed Pedagogical              107952\n 6        2019 Dept Of Ed Pedagogical              112064\n 7        2020 Dept Of Ed Pedagogical              114994\n 8        2021 Dept Of Ed Per Session Teacher      102326\n 9        2022 Dept Of Ed Pedagogical              110561\n10        2023 Dept Of Ed Pedagogical               57747\n11        2024 Dept Of Ed Pedagogical               73509\n\n\n\n\nQuestion 6: Which agency has the highest overtime usage (compared to regular hours)?\nFirst, we can calculate the total number of regular and overtime hours.\nFrom the output, we can see that although the Board of Elections doesn’t have the highest overtime hours worked, it has the highest percentage of total overtime relative to total regular hours.\n\n\nCode\nnyc_payroll|&gt;\n  group_by(agency_name) |&gt;\n  summarize(\n    total_regular_hours = sum(regular_hours), \n    total_ot_hours = sum(ot_hours), \n    ot_pct_of_regular = total_ot_hours/total_regular_hours\n    ) |&gt;\n  slice_max(ot_pct_of_regular, n = 1)\n\n\n# A tibble: 1 × 4\n  agency_name        total_regular_hours total_ot_hours ot_pct_of_regular\n  &lt;chr&gt;                            &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;\n1 Board Of Elections           15339960.       3062029.             0.200\n\n\n\n\nQuestion 7: What is the average salary of employees who work outside the five boroughs?\nEmployees who work outside the the five boroughs have an average salary of $91,475.31.\n\n\nCode\nnyc_payroll |&gt;\n  filter(! work_location_borough %in% c(\"Manhattan\", \"Brookly\", \"Queens\", \"Bronx\", \n                                        \"Staten Island\") ) |&gt;\n  summarize(avg_salary = sum(total_compensation)/ n_distinct(empl_id)) |&gt; \n  slice_max(avg_salary)\n\n\n  avg_salary\n1   91475.31\n\n\n\n\nQuestion 8: How much has the city’s aggregate payroll grown over the past years?\n\n\nCode\nnyc_payroll|&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(aggregate_payroll = sum(total_compensation)) |&gt;\n  arrange(fiscal_year) |&gt;\n  summarize(payroll_growth_rate = last(aggregate_payroll)/first(aggregate_payroll) - 1)\n\n\n# A tibble: 1 × 1\n  payroll_growth_rate\n                &lt;dbl&gt;\n1               0.351\n\n\n\n\nCode\nprint(sprintf(\"The city's aggregate payroll has grown %.2f%% over the past 10 fiscal years.\" , 0.3511706 * 100))\n\n\n[1] \"The city's aggregate payroll has grown 35.12% over the past 10 fiscal years.\""
  },
  {
    "objectID": "mp01.html#quick-facts",
    "href": "mp01.html#quick-facts",
    "title": "mini project 01",
    "section": "",
    "text": "Highest Pay Rate: The chairman of the Civil Service Commission in Manhattan has the highest pay rate, with an hourly rate $566.60.\nHighest Total Payroll: Combining regular and overtime pay, Daniel E Flynn from the Fire Department had the highest total payroll of $521,235.4 in 2021, having worked 1,820 regular hours and 1564.92 overtime hours.\nMost Overtime Worked: William E. Gittens from the Department Of Citywide Admin Services has the most overtime worked, which was 18,564 hours.\nHighest Average Total Annual Payroll Per Employee: The Office of Collective Bargaining has the highest average total annual payrollper employee, at $96,095.94.\nMost Employees on Payroll: The Department of Education has the most employees on the payroll each fiscal year.\nHighest Overtime Usage: The Board of Elections has the highest overtime usage, with total overtime worked accounting for about 20% of the total regular hours.\nAverage Salary for Employees Outside the Five Boroughs: Employees who work outside the five boroughs have an average salary of $91,475.31.\nAggregate Payroll Growth: The city’s aggregate payroll has grown by 35.12% over the past ten fiscal years."
  },
  {
    "objectID": "mp01.html#conventional-formatting",
    "href": "mp01.html#conventional-formatting",
    "title": "mini project 01",
    "section": "Conventional Formatting",
    "text": "Conventional Formatting\n\nConvert values some columns to conventional formatting using string_to_title().\nBy using the unique() function in R, we can get a list of distinct values for a variable. I noticed there are some shorthands in the agency_name variable and some agency names need formal formatting.\n\n\n\nCode\nnyc_payroll &lt;- nyc_payroll |&gt;\n  mutate(\n    agency_name = str_to_title(agency_name),\n    last_name = str_to_title(last_name),\n    first_name = str_to_title(first_name),\n    work_location_borough = str_to_title(work_location_borough),\n    title_description = str_to_title(title_description),\n    leave_status_as_of_june_30 = str_to_title(leave_status_as_of_june_30)\n  )\n\n\n\n\nCode\nnyc_payroll &lt;- nyc_payroll |&gt;\n  mutate(\n    agency_name = case_when(\n      agency_name == \"Bronx Da\" ~ \"Bronx District Attorney\",  \n      agency_name == \"Board Of Correction\" ~ \"Board Of Corrections\",\n      agency_name == \"Dept. Of Design & Construction\" ~ \"Dept Of Design & Construction\",\n      agency_name == \"Dept. Of Homeless Services\" ~ \"Dept Of Homeless Services\",\n      agency_name == \"Office Of Collective Bargainin\" ~ \"Office Of Collective Bargaining\",\n      agency_name == \"Board Of Election\" ~ \"Board Of Elections\",\n      agency_name == \"Doe Custodial Payrol\" ~ \"DOE Custodial Payroll\",\n      TRUE ~ agency_name\n    )\n  )"
  },
  {
    "objectID": "mp01.html#create-an-employee-salary-table-for-eric-l.-adams.",
    "href": "mp01.html#create-an-employee-salary-table-for-eric-l.-adams.",
    "title": "mini project 01",
    "section": "Create an employee salary table for Eric L. Adams.",
    "text": "Create an employee salary table for Eric L. Adams.\n\nnyc_payroll |&gt;\n  filter(first_name == \"Eric\" & last_name == \"Adams\" & title_description == \"Mayor\") |&gt;\n  mutate(\n    total_salary = regular_gross_paid + total_ot_paid\n  ) |&gt;\n  arrange(fiscal_year)\n\n  fiscal_year payroll_number         agency_name last_name first_name mid_init\n1        2022              2 Office Of The Mayor     Adams       Eric        L\n2        2023              2 Office Of The Mayor     Adams       Eric        L\n3        2024              2 Office Of The Mayor     Adams       Eric        L\n        agency_start_date work_location_borough title_description\n1 2022-01-01T00:00:00.000             Manhattan             Mayor\n2 2022-01-01T00:00:00.000             Manhattan             Mayor\n3 2022-01-01T00:00:00.000             Manhattan             Mayor\n  leave_status_as_of_june_30 base_salary pay_basis regular_hours\n1                     Active      258750 per Annum           842\n2                     Active      258750 per Annum          1820\n3                     Active      258750 per Annum          1820\n  regular_gross_paid ot_hours total_ot_paid total_other_pay total_salary\n1           120088.4        0             0               0     120088.4\n2           258041.2        0             0               0     258041.2\n3           257361.2        0             0               0     257361.2\n\n\n\ntbl_txt &lt;- \"\nFiscal Year, Position, Agency, Total Salary\n2022, Mayor, Office of the Mayor, 120088.4  \n2023, Mayor, Office of the Mayor, 258041.2\n2023, Mayor, Office of the Mayor, 257361.2\n\"\n\nread_csv(tbl_txt) |&gt; \n    mutate(`Total Salary` = dollar(`Total Salary`)) |&gt;\n    datatable(options=list(searching=FALSE, \n                           paging=FALSE,\n                           info=FALSE))"
  },
  {
    "objectID": "mp01.html#analzye-the-distribution-of-base_salary",
    "href": "mp01.html#analzye-the-distribution-of-base_salary",
    "title": "mini project 01",
    "section": "Analzye the distribution of base_salary",
    "text": "Analzye the distribution of base_salary\nIn order to perform payroll analyses, my first step is to examine the distribution of base_salary, which provides pay information for each pay basis. In NYC payroll data set, there are three pay types: per annum/prorated annual, per diem and per hour. For a robust analysis, I used summary() to identify the outliers and inconsistencies and addressed them accordingly.\n\nPer Annum Employees\nThere are some outliers in this category. For example, some observations have a $1 annual rate. After further investigation, I believe these are just not actual payroll records and are immaterial, so I decided no action was needed to handle these values. I applied a 1,820 hours to this group to compute the pay rate.\n\n\nCode\nnyc_payroll |&gt;\n  filter(pay_basis == \"per Annum\") |&gt;\n  select(base_salary) |&gt;\n  summary()\n\n\n  base_salary    \n Min.   :     1  \n 1st Qu.: 50028  \n Median : 74683  \n Mean   : 75786  \n 3rd Qu.: 95365  \n Max.   :414707  \n\n\n\n\nPer Hour Employees\nFrom the output below, it seems unreasonable that the maximum value for an hourly municipal employees was 184,931.45. Upon further investigation, I found that this value comes from the DOE Custodial Payroll, which has only one pay type-an hourly basis. Additionally, half of the records had a per hour rate exceeding $70,000, which suggests the pay is more likely based on an annual salary rather than an hourly rate.\nTo address the inconsistency between the pay basis and the base salary, I defined a reasonable hourly rate range of $100 for this agency. For observations that fell outside this range, I calculated the hourly pay rate using 1,820 hours.\n\n\nCode\nnyc_payroll |&gt;\n  filter(agency_name == \"DOE Custodial Payroll\") |&gt;\n  select(base_salary) |&gt;\n  summary()\n\n\n  base_salary    \n Min.   :     1  \n 1st Qu.:     1  \n Median : 73774  \n Mean   : 60435  \n 3rd Qu.:123636  \n Max.   :184931  \n\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(agency_name == \"DOE Custodial Payroll\") |&gt;\n  select(pay_basis) |&gt;\n  unique()\n\n\n  pay_basis\n1  per Hour\n\n\n\n\nPer Diem Employees\nLet’s explore the subset with pay_basis == per Day. We can see that half of the sample in this category have a base salary per day of less than $33.18. If we are converting the pay to an hourly rate by applying 7.5 hours, it’s likely that some values of base_salary are not consistent with the pay_basis being “per Day”.\nTo address this, I developed complex rules that take into account both regular hours and base salary, ensuring that the hourly pay falls within a reasonable range. For example, for the group of employees who worked over 650 regular hours and had a third quantile base salary of $380.90, I applied 7.5-hour workday to standardize the calculation.\n\n\nCode\nnyc_payroll |&gt;\n  filter(pay_basis == \"per Day\") |&gt;\n  select(\"base_salary\") |&gt;\n  summary()\n\n\n  base_salary     \n Min.   :   0.01  \n 1st Qu.:  33.18  \n Median :  33.18  \n Mean   :  83.18  \n 3rd Qu.: 110.29  \n Max.   : 999.95"
  },
  {
    "objectID": "mp01.html#missing-values",
    "href": "mp01.html#missing-values",
    "title": "mini project 01",
    "section": "Missing Values",
    "text": "Missing Values\n\nBe aware that there are over 10,000 missing values in first_name and last_name. Due to confidentiality, some first and last names have been replaced with ‘Xxxx’. For example, approximately 3,541 payroll records in the Police Department having missing names in the data set.\nI decided to exclude these records from the calculations for certain quick-facts related questions later.\n\n\n\nCode\nprint(any(is.na(nyc_payroll$first_name)))\n\n\n[1] TRUE\n\n\nCode\nprint(any(is.na(nyc_payroll$last_name)))\n\n\n[1] TRUE\n\n\nCode\nprint(sum(is.na(nyc_payroll$first_name)))\n\n\n[1] 14002\n\n\nCode\nprint(sum(is.na(nyc_payroll$last_name)))\n\n\n[1] 13934"
  },
  {
    "objectID": "mp01.html#question-1-which-job-title-has-the-highest-base-rate-of-pay",
    "href": "mp01.html#question-1-which-job-title-has-the-highest-base-rate-of-pay",
    "title": "mini project 01",
    "section": "Question 1: Which job title has the highest base rate of pay?",
    "text": "Question 1: Which job title has the highest base rate of pay?\n\nnyc_payroll |&gt;\n  slice_max(pay_rate, n = 1) |&gt;\n  select(agency_name, title_description, pay_rate)\n\n            agency_name  title_description pay_rate\n1 DOE Custodial Payroll Custodian Engineer 184931.5"
  },
  {
    "objectID": "mp01.html#question-2-whcih-individual-in-what-year-had-the-single-highest-city-total-payroll",
    "href": "mp01.html#question-2-whcih-individual-in-what-year-had-the-single-highest-city-total-payroll",
    "title": "mini project 01",
    "section": "Question 2: Whcih individual & in what year had the single highest city total payroll?",
    "text": "Question 2: Whcih individual & in what year had the single highest city total payroll?\n\nIn question 2 and 3, I filtered the dataset to include only observations with a real name.\nDaniel E Flynn from the Fire Department had the highest total payroll of $572,770.2 in 2021, having worked 2,080 regular hours and 1,564.92 overtime hours.\n\n\nnyc_payroll |&gt;\n  filter(! is.na(first_name) & ! is.na(last_name) & first_name != \"Xxxx\" & last_name != \"Xxxx\") |&gt;\n  slice_max(total_compensation, n = 1)\n\n  fiscal_year payroll_number     agency_name last_name first_name mid_init\n1        2021             57 Fire Department     Flynn     Daniel        E\n        agency_start_date work_location_borough  title_description\n1 1999-07-07T00:00:00.000              Brooklyn Chief Fire Marshal\n  leave_status_as_of_june_30 base_salary pay_basis regular_hours\n1                     Active      235462 per Annum          2080\n  regular_gross_paid ot_hours total_ot_paid total_other_pay pay_rate\n1           162911.4  1564.92      110078.9         6532.24   129.37\n       full_name total_compensation\n1 Daniel E Flynn           572770.2\n                                                    empl_id\n1 Daniel E Flynn_Chief Fire Marshal_1999-07-07T00:00:00.000"
  },
  {
    "objectID": "mp01.html#question-3-which-individual-worked-the-most-overtime-hours-in-this-data-set",
    "href": "mp01.html#question-3-which-individual-worked-the-most-overtime-hours-in-this-data-set",
    "title": "mini project 01",
    "section": "Question 3: Which individual worked the most overtime hours in this data set?",
    "text": "Question 3: Which individual worked the most overtime hours in this data set?\n\nIf we aggregate overtime hours by full_name only, the output may not be meaningful. For example, employees with the full name “Md S Islam” hold 20 different positions in NYC, indicating that the distinct employees share the same full name. To improve accuracy, I decided to group by empl_id instead.\nBased on the output, Willam E Gittens, who works as city custodial assistant had a total of 18,564 overtime hours.\n\n\nnyc_payroll |&gt;\n  filter(! is.na(first_name) & ! is.na(last_name) & first_name != \"Xxxx\" & last_name != \"Xxxx\") |&gt;\n  group_by(empl_id) |&gt;\n  summarize(n_ot_hours = sum(ot_hours)) |&gt;\n  slice_max(n_ot_hours, n = 1)\n\n# A tibble: 1 × 2\n  empl_id                                                            n_ot_hours\n  &lt;chr&gt;                                                                   &lt;dbl&gt;\n1 William E Gittens_City Custodial Assistant_2014-04-21T00:00:00.000     18565."
  },
  {
    "objectID": "mp01.html#question-4-which-agency-has-the-highest-average-total-annual-payroll-based-and-overtime-per-employee",
    "href": "mp01.html#question-4-which-agency-has-the-highest-average-total-annual-payroll-based-and-overtime-per-employee",
    "title": "mini project 01",
    "section": "Question 4: Which agency has the highest average total annual payroll (based and overtime per employee)?",
    "text": "Question 4: Which agency has the highest average total annual payroll (based and overtime per employee)?\nThe Office of Collective Bargaining has the highest average total annual payroll per employee $105,584.\n\nnyc_payroll |&gt;\n  group_by(fiscal_year, agency_name) |&gt;\n  summarize(\n    avg_annual_payroll = sum(total_compensation) / n_distinct(empl_id)\n    ) |&gt;\n  group_by(agency_name) |&gt;\n  summarize(avg_annual_payroll_by_agency = mean(avg_annual_payroll)) |&gt;\n  slice_max(avg_annual_payroll_by_agency, n = 1)\n\n# A tibble: 1 × 2\n  agency_name                     avg_annual_payroll_by_agency\n  &lt;chr&gt;                                                  &lt;dbl&gt;\n1 Office Of Collective Bargaining                      105584."
  },
  {
    "objectID": "mp01.html#question-5-which-agency-has-the-most-employees-on-the-payroll-in-each-year",
    "href": "mp01.html#question-5-which-agency-has-the-most-employees-on-the-payroll-in-each-year",
    "title": "mini project 01",
    "section": "Question 5: Which agency has the most employees on the payroll in each year?",
    "text": "Question 5: Which agency has the most employees on the payroll in each year?\nThe Department of Education has the most employees on the payroll in each fiscal year.\n\nnyc_payroll |&gt;\n  group_by(fiscal_year, agency_name) |&gt;\n  summarize(n_employees = n_distinct(empl_id)) |&gt;\n  slice_max(n_employees, n = 1)\n\n# A tibble: 11 × 3\n# Groups:   fiscal_year [11]\n   fiscal_year agency_name                    n_employees\n         &lt;int&gt; &lt;chr&gt;                                &lt;int&gt;\n 1        2014 Dept Of Ed Pedagogical              100583\n 2        2015 Dept Of Ed Pedagogical              111851\n 3        2016 Dept Of Ed Pedagogical              106256\n 4        2017 Dept Of Ed Pedagogical              104624\n 5        2018 Dept Of Ed Pedagogical              107952\n 6        2019 Dept Of Ed Pedagogical              112064\n 7        2020 Dept Of Ed Pedagogical              114994\n 8        2021 Dept Of Ed Per Session Teacher      102326\n 9        2022 Dept Of Ed Pedagogical              110561\n10        2023 Dept Of Ed Pedagogical               57747\n11        2024 Dept Of Ed Pedagogical               73509"
  },
  {
    "objectID": "mp01.html#question-6-which-agency-has-the-highest-overtime-usage-compared-to-regular-hours",
    "href": "mp01.html#question-6-which-agency-has-the-highest-overtime-usage-compared-to-regular-hours",
    "title": "mini project 01",
    "section": "Question 6: Which agency has the highest overtime usage (compared to regular hours)?",
    "text": "Question 6: Which agency has the highest overtime usage (compared to regular hours)?\nFirst, we can calculate the total number of regular and overtime hours.\nFrom the output, we can see that although the Board of Elections doesn’t have the highest overtime hours worked, it has the highest percentage of total overtime relative to total regular hours.\n\nnyc_payroll|&gt;\n  group_by(agency_name) |&gt;\n  summarize(\n    total_regular_hours = sum(regular_hours), \n    total_ot_hours = sum(ot_hours), \n    ot_pct_of_regular = total_ot_hours/total_regular_hours\n    ) |&gt;\n  slice_max(ot_pct_of_regular, n = 1)\n\n# A tibble: 1 × 4\n  agency_name        total_regular_hours total_ot_hours ot_pct_of_regular\n  &lt;chr&gt;                            &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;\n1 Board Of Elections           15339960.       3062029.             0.200"
  },
  {
    "objectID": "mp01.html#question-7-what-is-the-average-salary-of-employees-who-work-outside-the-five-boroughs",
    "href": "mp01.html#question-7-what-is-the-average-salary-of-employees-who-work-outside-the-five-boroughs",
    "title": "mini project 01",
    "section": "Question 7: What is the average salary of employees who work outside the five boroughs?",
    "text": "Question 7: What is the average salary of employees who work outside the five boroughs?\nEmployees who work outside the the five boroughs have an average salary of $91,475.31.\n\nnyc_payroll |&gt;\n  filter(! work_location_borough %in% c(\"Manhattan\", \"Brookly\", \"Queens\", \"Bronx\", \n                                        \"Staten Island\") ) |&gt;\n  summarize(avg_salary = sum(total_compensation)/ n_distinct(empl_id)) |&gt; \n  slice_max(avg_salary)\n\n  avg_salary\n1   91475.31"
  },
  {
    "objectID": "mp01.html#question-8-how-much-has-the-citys-aggregate-payroll-grown-over-the-past-years",
    "href": "mp01.html#question-8-how-much-has-the-citys-aggregate-payroll-grown-over-the-past-years",
    "title": "mini project 01",
    "section": "Question 8: How much has the city’s aggregate payroll grown over the past years?",
    "text": "Question 8: How much has the city’s aggregate payroll grown over the past years?\n\nnyc_payroll|&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(aggregate_payroll = sum(total_compensation)) |&gt;\n  arrange(fiscal_year) |&gt;\n  summarize(payroll_growth_rate = last(aggregate_payroll)/first(aggregate_payroll) - 1)\n\n# A tibble: 1 × 1\n  payroll_growth_rate\n                &lt;dbl&gt;\n1               0.351\n\n\n\nprint(sprintf(\"The city's aggregate payroll has grown %.2f%% over the past 10 fiscal years.\" , 0.3511706 * 100))\n\n[1] \"The city's aggregate payroll has grown 35.12% over the past 10 fiscal years.\""
  },
  {
    "objectID": "mp01.html#capping-salaries-at-mayoral-level",
    "href": "mp01.html#capping-salaries-at-mayoral-level",
    "title": "mini project 01",
    "section": "Capping Salaries at Mayoral Level",
    "text": "Capping Salaries at Mayoral Level\nThe first policy is to cap salaries at the Mayoral level. It’s worth noting that Mayor Bloomberg’s salary in 2014 was $1, which was an exception. To ensure a fair analysis, I adjusted it to reflect a standard NYC mayor’s pay.\nFirst, I computed the total mayor pay for each fiscal year and used it as a benchmark to identify the employees whose total compensation exceeded the amount in the same fiscal year. From there, I conducted a salary cap analysis.\nBased on my analysis, if the salary cap policy had been implemented, it would have saved a total of $92,359,814 over the past ten fiscal years. And the captains from the Fire Department and the Department of Correction would bear the most brunt of the salary cap.\nHere is something interesting to note: If we only consider their base salaries, they are actually below the benchmark. However, since 2015, they have worked an average of 1,300 overtime hours per year, which led to their total compensation exceeding the Mayor’s level. Next, I will explore the impact of reducing the overtime hours by increasing full-time employment.\n\n\nCode\nbenchmark &lt;- nyc_payroll |&gt;\n  filter(title_description == \"Mayor\") |&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(total_mayor_pay = sum(case_when(\n    fiscal_year == 2014 ~ 2 * total_compensation,\n    TRUE ~ total_compensation)) \n  )\n\n\n\n\nCode\nnyc_payroll &lt;- nyc_payroll |&gt;\n  left_join(benchmark, by = \"fiscal_year\") |&gt;\n  rename(salary_cap = total_mayor_pay) |&gt;\n  mutate(\n    is_above_the_cap = ifelse(\n      total_compensation &gt; salary_cap, \"Yes\", \"No\"\n    ),\n    pay_savings_from_cap = ifelse(\n      is_above_the_cap == \"Yes\", round(total_compensation - salary_cap, 2), 0\n    )\n  )\n\n\n\n\nCode\nsum(nyc_payroll$pay_savings_from_cap)\n\n\n[1] 92359814\n\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(is_above_the_cap == \"Yes\") |&gt;\n  group_by(agency_name, title_description) |&gt;\n  summarize(total_savings = sum(pay_savings_from_cap)) |&gt;\n  arrange(desc(total_savings))\n\n\n# A tibble: 320 × 3\n# Groups:   agency_name [63]\n   agency_name                   title_description                 total_savings\n   &lt;chr&gt;                         &lt;chr&gt;                                     &lt;dbl&gt;\n 1 Department Of Correction      Captain                               13433166.\n 2 Fire Department               Captain                                9358013.\n 3 Department Of Correction      Warden-Assistant Deputy Warden T…      6921116.\n 4 Department Of Correction      Correction Officer                     4806111.\n 5 Police Department             Police Officer D/A Detective 1st…      3776059.\n 6 Police Department             Lieutenant D/A Commander Of Dete…      3412895.\n 7 Police Department             Captain Detailed As Assistant Ch…      2850212.\n 8 Police Department             Lieutenant D/A Special Assignment      2731127.\n 9 Department Of Correction      Senior Stationary Engineer             2522180.\n10 Dept Of Health/Mental Hygiene City Medical Examiner                  2513273.\n# ℹ 310 more rows\n\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(is_above_the_cap == \"Yes\", agency_name %in% c(\"Department Of Correction\", \"Fire Department\"), \n         title_description == \"Captain\") |&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(mean(ot_hours))\n\n\n# A tibble: 9 × 2\n  fiscal_year `mean(ot_hours)`\n        &lt;int&gt;            &lt;dbl&gt;\n1        2015            1429.\n2        2016            1525.\n3        2017            1435.\n4        2018            1612.\n5        2020            1550.\n6        2021            1418.\n7        2022            1444.\n8        2023            1302.\n9        2024            1154."
  },
  {
    "objectID": "mp01.html#increasing-staffing-to-reduce-overtime-expenses",
    "href": "mp01.html#increasing-staffing-to-reduce-overtime-expenses",
    "title": "mini project 01",
    "section": "Increasing Staffing to Reduce Overtime Expenses",
    "text": "Increasing Staffing to Reduce Overtime Expenses\nNow, I wanted to explore the the impact and savings by increasing staffing to reduce overtime hours. First, I aggregated the total overtime hours for each combination of agency and job title and calculated the number of full-time employee equivalents using a standard of 1,820 hours per full-time employee. Using the average pay rate for each combination of agency and position, I then computed the potential full-time salary if overtime hours were replaced by equivalent full-time positions.\nFrom my analysis, we can see that replacing overtime hours with full-time employees would have resulted in total savings of $8,293,349,444 over the past ten fiscal years. This policy proves to be more effective in generating savings than the salary cap.\nAs previously mentioned, there are actually very few municipal employees whose base salaries exceed the Mayor’s salary. The main reason their total compensation surpasses this level is the significant amount of overtime worked.\nIn addition, we can see that a 50% savings can be achieved from increasing the number of full-time employees to reduce overtime hours, particularly in the Police Department and the Fire Department.\n\n\nCode\novertime_replacement &lt;- nyc_payroll |&gt;\n  mutate(agency_role = paste(agency_name, title_description, sep = \"_\")) |&gt;\n  group_by(fiscal_year, agency_role) |&gt;\n  summarize(avg_pay_rate = mean(pay_rate), total_ot_worked = sum(ot_hours)) |&gt;\n  filter(total_ot_worked &gt; 0) |&gt;\n  mutate(\n    full_time_equivalent = round(total_ot_worked/1820, 6),\n    full_time_pay = round(avg_pay_rate * full_time_equivalent * 1820, 2),\n    ot_reduction_savings = total_ot_worked * 1.5 * avg_pay_rate - full_time_pay,\n    agency = str_extract(agency_role, \"^[^_]+\")\n  ) |&gt;\n  ungroup() |&gt;\n  mutate(\n    total_savings = sum(ot_reduction_savings),\n    savings_pct_of_total = ot_reduction_savings/total_savings\n    )\n\n\n\n\nCode\novertime_replacement |&gt;\n  group_by(agency) |&gt;\n  summarize(total_savings_pct_by_agency = round(sum(savings_pct_of_total), 6)) |&gt;\n  arrange(desc(total_savings_pct_by_agency))\n\n\n# A tibble: 93 × 2\n   agency                         total_savings_pct_by_agency\n   &lt;chr&gt;                                                &lt;dbl&gt;\n 1 Police Department                                   0.383 \n 2 Fire Department                                     0.190 \n 3 Department Of Correction                            0.112 \n 4 Department Of Sanitation                            0.0799\n 5 Nyc Housing Authority                               0.0566\n 6 Department Of Transportation                        0.0321\n 7 Dept Of Environment Protection                      0.0249\n 8 Hra/Dept Of Social Services                         0.0246\n 9 Admin For Children's Svcs                           0.0208\n10 Dept Of Citywide Admin Svcs                         0.0120\n# ℹ 83 more rows\n\n\n\n\nCode\nsum(overtime_replacement$ot_reduction_savings)\n\n\n[1] 8293349444"
  },
  {
    "objectID": "mp01.html#create-your-own-policy-proposal",
    "href": "mp01.html#create-your-own-policy-proposal",
    "title": "mini project 01",
    "section": "Create Your Own Policy Proposal",
    "text": "Create Your Own Policy Proposal"
  },
  {
    "objectID": "mp01.html#create-an-employee-salary-table-for-eric-l.-adams",
    "href": "mp01.html#create-an-employee-salary-table-for-eric-l.-adams",
    "title": "mini project 01",
    "section": "Create an employee salary table for Eric L. Adams",
    "text": "Create an employee salary table for Eric L. Adams\n\n\nCode\nnyc_payroll |&gt;\n  filter(first_name == \"Eric\" & last_name == \"Adams\" & title_description == \"Mayor\") |&gt;\n  mutate(\n    total_salary = regular_gross_paid + total_ot_paid\n  ) |&gt;\n  arrange(fiscal_year)\n\n\n  fiscal_year payroll_number         agency_name last_name first_name mid_init\n1        2022              2 Office Of The Mayor     Adams       Eric        L\n2        2023              2 Office Of The Mayor     Adams       Eric        L\n3        2024              2 Office Of The Mayor     Adams       Eric        L\n        agency_start_date work_location_borough title_description\n1 2022-01-01T00:00:00.000             Manhattan             Mayor\n2 2022-01-01T00:00:00.000             Manhattan             Mayor\n3 2022-01-01T00:00:00.000             Manhattan             Mayor\n  leave_status_as_of_june_30 base_salary pay_basis regular_hours\n1                     Active      258750 per Annum           842\n2                     Active      258750 per Annum          1820\n3                     Active      258750 per Annum          1820\n  regular_gross_paid ot_hours total_ot_paid total_other_pay total_salary\n1           120088.4        0             0               0     120088.4\n2           258041.2        0             0               0     258041.2\n3           257361.2        0             0               0     257361.2\n\n\n\n\nCode\ntbl_txt &lt;- \"\nFiscal Year, Position, Agency, Total Salary\n2022, Mayor, Office of the Mayor, 120088.4  \n2023, Mayor, Office of the Mayor, 258041.2\n2023, Mayor, Office of the Mayor, 257361.2\n\"\n\nread_csv(tbl_txt) |&gt; \n    mutate(`Total Salary` = dollar(`Total Salary`)) |&gt;\n    datatable(options=list(searching=FALSE, \n                           paging=FALSE,\n                           info=FALSE))"
  },
  {
    "objectID": "mp01.html#eric-l.-adams",
    "href": "mp01.html#eric-l.-adams",
    "title": "mini project 01",
    "section": "Eric L. Adams",
    "text": "Eric L. Adams\nBelow is a table showing the total pay for NYC’s current Mayor. The Mayor of New York City takes office in January, while the fiscal year runs from July to June. As a result, his pay in 2022 was only half of the total annual pay.\n\n\nCode\nnyc_payroll |&gt;\n  filter(first_name == \"Eric\" & last_name == \"Adams\" & title_description == \"Mayor\") |&gt;\n  mutate(\n    total_salary = regular_gross_paid + total_ot_paid\n  ) |&gt;\n  arrange(fiscal_year)\n\n\n\n\nCode\ntbl_txt &lt;- \"\nFiscal Year, Position, Agency, Total Salary\n2022, Mayor, Office of the Mayor, 120088.4  \n2023, Mayor, Office of the Mayor, 258041.2\n2023, Mayor, Office of the Mayor, 257361.2\n\"\n\nread_csv(tbl_txt) |&gt; \n    mutate(`Total Salary` = dollar(`Total Salary`)) |&gt;\n    datatable(options=list(searching=FALSE, \n                           paging=FALSE,\n                           info=FALSE))"
  },
  {
    "objectID": "mp01.html#introduction",
    "href": "mp01.html#introduction",
    "title": "mini project 01",
    "section": "",
    "text": "In this project, we will use the data from NYC Open Data. The data set contains 6,225,611 payroll records and 17 variables, covering payroll information for about 160 agencies in NYC from fiscal years 2014 to 2024. Our goal is to analyze the payroll and evaluate three policy proposals designed to reduce the city’s total payroll expenses.\n\n\n\nHighest Pay Rate: The chairman of the Civil Service Commission in Manhattan has the highest pay rate, with an hourly rate $566.60.\nHighest Total Payroll: Combining regular and overtime pay, Daniel E Flynn from the Fire Department had the highest total payroll of $521,235.4 in 2021, having worked 1,820 regular hours and 1564.92 overtime hours.\nMost Overtime Worked: William E. Gittens from the Department Of Citywide Admin Services has the most overtime worked, which was 18,564 hours.\nHighest Average Total Annual Payroll Per Employee: The Office of Collective Bargaining has the highest average total annual payrollper employee, at $96,095.94.\nMost Employees on Payroll: The Department of Education has the most employees on the payroll each fiscal year.\nHighest Overtime Usage: The Board of Elections has the highest overtime usage, with total overtime worked accounting for about 20% of the total regular hours.\nAverage Salary for Employees Outside the Five Boroughs: Employees who work outside the five boroughs have an average salary of $91,475.31.\nAggregate Payroll Growth: The city’s aggregate payroll has grown by 35.12% over the past ten fiscal years."
  },
  {
    "objectID": "mp01.html#acquire-data-and-import-data-into-r",
    "href": "mp01.html#acquire-data-and-import-data-into-r",
    "title": "mini project 01",
    "section": "Acquire Data and Import Data into R",
    "text": "Acquire Data and Import Data into R\nLoad Relevant Packages\n\n\nCode\nlibrary(tidyverse)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(DT)\nlibrary(scales)\n\n\nRead Data in R\n\n\nCode\nnyc_payroll &lt;- read.csv(\"~/STA9750/STA9750-2025-SPRING/data/mp01/nyc_payroll_export.csv\")\n\n\nNow, let’s take a quick look at the payroll data.\n\n\nCode\nglimpse(nyc_payroll)"
  },
  {
    "objectID": "mp01.html#exploratory-data-analysis",
    "href": "mp01.html#exploratory-data-analysis",
    "title": "NYC Payroll Expenses Reduction Proposal",
    "section": "Exploratory Data Analysis",
    "text": "Exploratory Data Analysis\n\nConventional Formatting\nConvert the values in some columns to conventional formatting using string_to_title().\nBy using the unique() function in R, we can get a list of distinct values for a variable. I noticed there are some shorthands in the agency_name variable and some agency names need formal formatting.\n\n\nCode\nnyc_payroll &lt;- nyc_payroll |&gt;\n  mutate(\n    agency_name = str_to_title(agency_name),\n    last_name = str_to_title(last_name),\n    first_name = str_to_title(first_name),\n    work_location_borough = str_to_title(work_location_borough),\n    title_description = str_to_title(title_description),\n    leave_status_as_of_june_30 = str_to_title(leave_status_as_of_june_30)\n  )\n\n\n\n\nCode\nnyc_payroll &lt;- nyc_payroll |&gt;\n  mutate(\n    agency_name = case_when(\n      agency_name == \"Bronx Da\" ~ \"Bronx District Attorney\",  \n      agency_name == \"Board Of Correction\" ~ \"Board Of Corrections\",\n      agency_name == \"Dept. Of Design & Construction\" ~ \"Dept Of Design & Construction\",\n      agency_name == \"Dept. Of Homeless Services\" ~ \"Dept Of Homeless Services\",\n      agency_name == \"Office Of Collective Bargainin\" ~ \"Office Of Collective Bargaining\",\n      agency_name == \"Board Of Election\" ~ \"Board Of Elections\",\n      agency_name == \"Doe Custodial Payrol\" ~ \"DOE Custodial Payroll\",\n      TRUE ~ agency_name\n    )\n  )\n\n\nAfter applying some conventional formatting, we can explore the dataset, beginning with the salary history of the NYC Mayor.\nBelow is a table showing the total pay for the current Mayor of New York City. The Mayor of New York City takes office in January, while the fiscal year runs from July to June. As a result, his pay in 2022 was only half of the total annual pay.\n\n\n\n\n\n\nSalary Table for Eric L. Adams\n\n\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(first_name == \"Eric\" & last_name == \"Adams\" & title_description == \"Mayor\") |&gt;\n  mutate(\n    total_salary = regular_gross_paid + total_ot_paid\n  ) |&gt;\n  arrange(fiscal_year)\n\n\n\n\nCode\ntbl_txt &lt;- \"\nFiscal Year, Position, Agency, Total Salary\n2022, Mayor, Office of the Mayor, 120088.4  \n2023, Mayor, Office of the Mayor, 258041.2\n2023, Mayor, Office of the Mayor, 257361.2\n\"\n\nread_csv(tbl_txt) |&gt; \n    mutate(`Total Salary` = dollar(`Total Salary`)) |&gt;\n    datatable(options=list(searching=FALSE, \n                           paging=FALSE,\n                           info=FALSE))\n\n\n\n\n\n\n\n\n\n\nAnalzye the Distribution of base_salary\nIn order to perform payroll analyses, my first step is to examine the distribution of base_salary, which provides pay information for each pay basis. In NYC payroll data set, there are three pay types: per annum/prorated annual, per diem and per hour. For a robust analysis, I used summary() to identify the outliers and inconsistencies and addressed them accordingly.\n\nPer Annum Employees\nThere are some outliers in this category. For example, some observations have a $1 annual rate. After further investigation, I believe these are just not actual payroll records and are immaterial, so I decided no action was needed to handle these values. I applied a 1,820 hours to this group to compute the pay rate.\n\n\nCode\nnyc_payroll |&gt;\n  filter(pay_basis == \"per Annum\") |&gt;\n  select(base_salary) |&gt;\n  summary()\n\n\n\n\nPer Hour Employees\nFrom the output below, it seems unreasonable that the maximum value for an hourly municipal employees was 184,931.45. Upon further investigation, I found that this value comes from the DOE Custodial Payroll, which has only one pay type-an hourly basis. Additionally, half of the records had a per hour rate exceeding $70,000, which suggests the pay is more likely based on an annual salary rather than an hourly rate.\nTo address the inconsistency between the pay basis and the base salary, I defined a reasonable hourly rate range of $100 for this agency. For observations that fell outside this range, I calculated the hourly pay rate using 1,820 hours.\n\n\nCode\nnyc_payroll |&gt;\n  filter(agency_name == \"DOE Custodial Payroll\") |&gt;\n  select(base_salary) |&gt;\n  summary()\n\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(agency_name == \"DOE Custodial Payroll\") |&gt;\n  select(pay_basis) |&gt;\n  unique()\n\n\n\n\nPer Diem Employees\nLet’s explore the subset with pay_basis == per Day. We can see that half of the sample in this category have a base salary per day of less than $33.18. If we are converting the pay to an hourly rate by applying 7.5 hours, it’s likely that some values of base_salary are not consistent with the pay_basis being “per Day”.\nTo address this, I developed complex rules that take into account both regular hours and base salary, ensuring that the hourly pay falls within a reasonable range. For example, for the group of employees who worked over 650 regular hours and had a third quantile base salary of $380.90, I applied 7.5-hour workday to standardize the calculation.\n\n\nCode\nnyc_payroll |&gt;\n  filter(pay_basis == \"per Day\") |&gt;\n  select(\"base_salary\") |&gt;\n  summary()\n\n\n\n\n\nMissing Values\nBe aware that there are over 10,000 missing values in first_name and last_name. Due to confidentiality, some first and last names have been replaced with ‘Xxxx’. For example, approximately 3,541 payroll records in the Police Department having missing names in the data set.\nI decided to exclude these records from the calculations for certain quick-facts related questions later.\n\n\nCode\nprint(any(is.na(nyc_payroll$first_name)))\nprint(any(is.na(nyc_payroll$last_name)))\nprint(sum(is.na(nyc_payroll$first_name)))\nprint(sum(is.na(nyc_payroll$last_name)))"
  },
  {
    "objectID": "mp01.html#feature-engineering",
    "href": "mp01.html#feature-engineering",
    "title": "NYC Payroll Expenses Reduction Proposal",
    "section": "Feature Engineering",
    "text": "Feature Engineering\n\nAfter analyzing the distribution of base_salary for each pay_basis, we can create a new variable called pay_rate to make these observations in the data set comparable.\nTo calculate the total compensation at the employee level, I would like to create a variable full_name that concatenates first_name, mid_init and last_name. I chose not to include mid_init for records where mid_init is not a letter.\nCaveat: The new variable full_name is not ideal as a primary key. One obvious drawback is it may not be unique, as some employees can share the same first and last names.\nI chose to create another variable called empl_id, which concatenates full_name, title_description, and agency_start_date. This will improve the accuracy of calculations at the employee level.\nI also created a variable called total_compensation, which shows the total pay, including both regular hours worked and overtime hours.\n\n\n\nCode\nnyc_payroll &lt;- nyc_payroll |&gt;\n  mutate(\n    pay_rate = case_when(\n      pay_basis %in% c(\"per Annum\", \"Prorated Annual\") ~ round(base_salary/1820, 2),\n      pay_basis == \"per Day\" & regular_hours &gt;= 650 ~ round(base_salary/7.5, 2),\n      pay_basis == \"per Day\" & regular_hours &lt; 650 & base_salary &lt; 40 ~ base_salary,\n      pay_basis == \"per Day\" & regular_hours &lt; 650 & base_salary &gt;= 40 & base_salary &lt; 250 ~ round(base_salary/2, 2),\n      pay_basis == \"per Day\" & regular_hours &lt; 650 & base_salary &gt;= 250 & base_salary &lt; 500 ~ round(base_salary/4, 2),\n      pay_basis == \"per Day\" & regular_hours &lt; 650 & base_salary &gt;= 500 ~ round (base_salary/5, 2),\n      pay_basis == \"per Hour\" & agency_name != \"DOE Custodial Payroll\" ~ base_salary,\n      pay_basis == \"per Hour\" & agency_name == \"DOE Custodial Payroll\" & base_salary &lt; 100 ~ base_salary,\n      pay_basis == \"per Hour\" & agency_name == \"DOE Custodial Payroll\" & base_salary &gt; 100 ~ round(base_salary/1820, 2)\n    ),\n    full_name = ifelse(\n      grepl(\"^[A-Za-z]$\", mid_init), \n      paste(first_name, mid_init, last_name),\n      paste(first_name, last_name)\n    ),\n    total_compensation = pay_rate * regular_hours + 1.5 * pay_rate * ot_hours,\n    empl_id = paste(full_name, title_description, agency_start_date, sep = \"_\")\n  )\n\n\nThe section shows the calculations used to derive the Quick Facts mentioned earlier.\n\n\n\n\n\n\nCalculations Related to Qucik Facts\n\n\n\n\nWhich job title has the highest base rate of pay?\n\n\n\nCode\nnyc_payroll |&gt;\n  slice_max(pay_rate, n = 1) |&gt;\n  select(agency_name, title_description, pay_rate)\n\n\n\nWhich individual & in what year had the single highest city total payroll?\n\n\nIn question 2 and 3, I filtered the dataset to include only observations with a real name.\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(! is.na(first_name) & ! is.na(last_name) & \n           first_name != \"Xxxx\" & last_name != \"Xxxx\") |&gt;\n  slice_max(total_compensation, n = 1) |&gt;\n  select(fiscal_year, agency_name, full_name, regular_hours, ot_hours, \n         total_compensation)\n\n\n\nWhich individual worked the most overtime hours in this data set?\n\n\nIf we aggregate overtime hours by full_name only, the output may not be meaningful. For example, employees with the full name “Md S Islam” hold 20 different positions in NYC, indicating that the distinct employees share the same full name. To improve accuracy, I decided to group by empl_id instead.\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(! is.na(first_name) & ! is.na(last_name) & first_name != \"Xxxx\" \n         & last_name != \"Xxxx\") |&gt;\n  group_by(empl_id) |&gt;\n  summarize(n_ot_hours = sum(ot_hours)) |&gt;\n  slice_max(n_ot_hours, n = 1) \n\n\n\nWhich agency has the highest average total annual payroll (based and overtime per employee)?\n\n\n\nCode\nnyc_payroll |&gt;\n  group_by(fiscal_year, agency_name) |&gt;\n  summarize(\n    avg_annual_payroll = sum(total_compensation) / n_distinct(empl_id)\n    ) |&gt;\n  group_by(agency_name) |&gt;\n  summarize(avg_annual_payroll_by_agency = mean(avg_annual_payroll)) |&gt;\n  slice_max(avg_annual_payroll_by_agency, n = 1)\n\n\n\nWhich agency has the most employees on the payroll in each year?\n\n\n\nCode\nnyc_payroll |&gt;\n  group_by(fiscal_year, agency_name) |&gt;\n  summarize(n_employees = n_distinct(empl_id)) |&gt;\n  slice_max(n_employees, n = 1)\n\n\n\nWhich agency has the highest overtime usage (compared to regular hours)?\n\n\nFirst, we can calculate the total number of regular and overtime hours.\nAlthough the Board of Elections doesn’t have the highest overtime hours worked, it has the highest percentage of total overtime relative to total regular hours.\n\n\n\nCode\nnyc_payroll|&gt;\n  group_by(agency_name) |&gt;\n  summarize(\n    total_regular_hours = sum(regular_hours), \n    total_ot_hours = sum(ot_hours), \n    ot_pct_of_regular = total_ot_hours/total_regular_hours\n    ) |&gt;\n  slice_max(ot_pct_of_regular, n = 1)\n\n\n\nWhat is the average salary of employees who work outside the five boroughs?\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(! work_location_borough %in% c(\"Manhattan\", \"Brookly\", \"Queens\", \"Bronx\", \n                                        \"Staten Island\") ) |&gt;\n  summarize(avg_salary = sum(total_compensation)/ n_distinct(empl_id)) |&gt; \n  slice_max(avg_salary)\n\n\n\nHow much has the city’s aggregate payroll grown over the past years?\n\n\n\nCode\nnyc_payroll|&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(aggregate_payroll = sum(total_compensation)) |&gt;\n  arrange(fiscal_year) |&gt;\n  summarize(payroll_growth_rate = last(aggregate_payroll)/first(aggregate_payroll) - 1)"
  },
  {
    "objectID": "mp01.html#policy-analysis",
    "href": "mp01.html#policy-analysis",
    "title": "mini project 01",
    "section": "Policy Analysis",
    "text": "Policy Analysis\n\nCapping Salaries at Mayoral Level\nThe first policy is to cap salaries at the Mayoral level. It’s worth noting that Mayor Bloomberg’s salary in 2014 was $1, which was an exception. To ensure a fair analysis, I adjusted it to reflect a standard NYC mayor’s pay.\nFirst, I computed the total mayor pay for each fiscal year and used it as a benchmark to identify the employees whose total compensation exceeded the amount in the same fiscal year. From there, I conducted a salary cap analysis.\nBased on my analyses, if the salary cap policy had been implemented, it would have saved a total of $92,359,814 over the past ten fiscal years. And the captains from the Fire Department and the Department of Correction would bear the most brunt of the policy. The savings from the two department would account for about 60%.\nThe table displays the total savings by fiscal year.\n\n\n\nFiscal Year\nTotal Savings\n\n\n\n\n2014\n285,683.3\n\n\n2015\n1,417,842.1\n\n\n2016\n3,282,571.1\n\n\n2017\n5,026,507.1\n\n\n2018\n435,666.2\n\n\n2019\n1,188,031.1\n\n\n2020\n6,788,684.0\n\n\n2021\n7,025,046.8\n\n\n2022\n27,990,701.4\n\n\n2023\n9,072,817.2\n\n\n2024\n29,846,263.4\n\n\n\n\n\nCode\nbenchmark &lt;- nyc_payroll |&gt;\n  filter(title_description == \"Mayor\") |&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(total_mayor_pay = sum(case_when(\n    fiscal_year == 2014 ~ 2 * total_compensation,\n    TRUE ~ total_compensation)) \n  )\n\nnyc_payroll &lt;- nyc_payroll |&gt;\n  left_join(benchmark, by = \"fiscal_year\") |&gt;\n  rename(salary_cap = total_mayor_pay) |&gt;\n  mutate(\n    is_above_the_cap = ifelse(\n      total_compensation &gt; salary_cap, \"Yes\", \"No\"\n    ),\n    pay_savings_from_cap = ifelse(\n      is_above_the_cap == \"Yes\", round(total_compensation - salary_cap, 2), 0\n    )\n  )\n\n\nWe can see from the bar chart below that total savings in 2022 and 2024 are significant; which is consistent with the fact that those years have the highest number of employees whose total compensation exceeds the Mayor’s pay.\n\n\nCode\nsavings_by_fiscal_year &lt;-nyc_payroll |&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(total_savings = sum(pay_savings_from_cap))\n\nggplot(savings_by_fiscal_year, aes(x = factor(fiscal_year), y = total_savings)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\", color = \"grey\") +\n  labs(\n    title = \" Chart 1: Potential Savings by Fiscal Year\",\n    x = \"Fiscal Year\",\n    y = \"Total Savings (USD)\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(is_above_the_cap == \"Yes\") |&gt;\n  group_by(agency_name, title_description) |&gt;\n  summarize(total_savings = sum(pay_savings_from_cap)) |&gt;\n  arrange(desc(total_savings))\n\n\nBelow is the top ten combination of agency and role ranked by the total savings from the salary cap. We can see that the capital\n\n\n\n\n\n\n\n\nAgency Name\nPosition\nTotal Savings\n\n\n\n\nDepartment Of Correction\nCaptain\n13,433,166.03\n\n\nFire Department\nCaptain\n9,358,012.85\n\n\nDepartment Of Correction\nWarden-Assistant Deputy Warden Ted\n6,921,116.26\n\n\nDepartment Of Correction\nCorrection Officer\n4,806,111.44\n\n\nPolice Department\nPolice Officer D/A Detective 1st Gr\n3,776,058.95\n\n\nPolice Department\nLieutenant D/A Commander Of Detective Squad\n3,412,895.39\n\n\nPolice Department\nCaptain Detailed As Assistant Chief Inspector\n2,850,211.89\n\n\nPolice Department\nLieutenant D/A Special Assignment\n2,731,126.69\n\n\nDepartment Of Correction\nSenior Stationary Engineer\n2,522,180.13\n\n\nDept Of Health/Mental Hygiene\nCity Medical Examiner\n2,513,273.14\n\n\n\n\n\nCode\ntotal_savings_pct_by_agency &lt;- nyc_payroll |&gt;\n  filter(is_above_the_cap == \"Yes\") |&gt;\n  group_by(agency_name) |&gt;\n  summarize(savings_percentage = round(sum(pay_savings_from_cap)/92359814, 2)) |&gt;\n  mutate(\n    agency_name = case_when(\n      savings_percentage &gt; 0.1 ~ agency_name,\n      TRUE ~ \"Others\"\n    )\n  ) |&gt;\n  group_by(agency_name) |&gt;\n  summarize(total_savings_percentage_by_agency = sum(savings_percentage))\n\n\n\n\nCode\ntotal_savings_pct_by_agency &lt;- total_savings_pct_by_agency |&gt;\n  mutate(\n    label = paste(agency_name, scales::percent(total_savings_percentage_by_agency))\n  )\n\nggplot(total_savings_pct_by_agency, aes(x = \"\", y = total_savings_percentage_by_agency, fill = agency_name)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  geom_text(aes(label = label), position = position_stack(vjust = 0.5), color = \"white\", size = 3) +\n  labs(\n    title = \"Total Savings Percentage by Agency\",\n    fill = \"Agency\",\n    caption = \"Source: NYC Payroll Data\"\n  ) +\n  scale_fill_manual(values = c(\n    \"Department Of Correction\" = \"steelblue\",\n    \"Fire Department\" = \"darkorange\",\n    \"Others\" = \"firebrick\",\n    \"Police Department\" = \"darkgreen\"\n    \n  )) +\n  theme(plot.title = element_text(hjust = 0.5),\n        plot.caption = element_text(hjust = 0.5, face = \"italic\", size = 10)\n        )\n\n\n\n\n\n\n\n\n\nHere is something interesting to note: If we only consider their base salaries, they are actually below the benchmark. However, since 2015, they have worked an average of 1,300 overtime hours per year, which led to their total compensation exceeding the Mayor’s level.\n\n\nCode\nnyc_payroll |&gt;\n  filter(is_above_the_cap == \"Yes\") |&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(mean(ot_hours), mean(base_salary), sum(pay_savings_from_cap))\n\n\n\n\n\n\n\n\n\n\nFiscal Year\nTotal Average Overtime Hours Worked\nAverage Base Salary\n\n\n\n\n2015\n1429.180\n103727.5\n\n\n2016\n1525.383\n101224.5\n\n\n2017\n1435.201\n105414.0\n\n\n2018\n1612.188\n106175.0\n\n\n2020\n1549.817\n113770.3\n\n\n2021\n1418.045\n122421.2\n\n\n2022\n1443.758\n126856.9\n\n\n2023\n1301.989\n127227.9\n\n\n2024\n1154.149\n138945.3\n\n\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(is_above_the_cap == \"Yes\", agency_name %in% c(\"Department Of Correction\", \"Fire Department\"), \n         title_description == \"Captain\") |&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(mean(ot_hours), mean(base_salary))\n\n\nIn conclusion, I do not recommend implementing a salary cap policy as I do not believe it will be effective. The reason is that very few employees have a base salary exceeding the Mayor’s salary.\nEven if we cap their salaries, those entitled to overtime pay would likely nullify the policy’s impact. For instance, a captain in the Department of Correction and a captain in the Fire Department had total compensation exceeding the Mayor’s salary. However, their base salaries were only half of the Mayor’s. It was theri overtime earnings that pushed their total pay above the benchmark.\nTherefore, I do not believe a salary cap would be an effective solution.\n\n\nIncreasing Staffing to Reduce Overtime Expenses\nTo explore the the impact and savings by increasing staffing to reduce overtime hours. First, I aggregated the total overtime hours for each combination of agency and job title and calculated the number of full-time employee equivalents using a standard of 1,820 hours per full-time employee. Using the average pay rate for each combination of agency and position, I then computed the potential full-time salary if overtime hours were replaced by equivalent full-time positions.\nFrom my analyses, we can see that replacing overtime hours with full-time employees would have resulted in total savings of $8,293,349,444 over the past ten fiscal years. This policy proves to be more effective in generating savings than the salary cap.\nAs previously mentioned, there are actually very few municipal employees whose base salaries exceed the Mayor’s salary. The main reason their total compensation surpasses this level is the significant amount of overtime worked.\nIn addition, we can see that a 50% savings can be achieved from increasing the number of full-time employees to reduce overtime hours, particularly in the Police Department and the Fire Department.\n\n\nCode\novertime_replacement &lt;- nyc_payroll |&gt;\n  mutate(agency_role = paste(agency_name, title_description, sep = \"_\")) |&gt;\n  group_by(fiscal_year, agency_role) |&gt;\n  summarize(avg_pay_rate = mean(pay_rate), total_ot_worked = sum(ot_hours)) |&gt;\n  filter(total_ot_worked &gt; 0) |&gt;\n  mutate(\n    full_time_equivalent = round(total_ot_worked/1820, 6),\n    full_time_pay = round(avg_pay_rate * full_time_equivalent * 1820, 2),\n    ot_reduction_savings = total_ot_worked * 1.5 * avg_pay_rate - full_time_pay,\n    agency = str_extract(agency_role, \"^[^_]+\")\n  ) |&gt;\n  ungroup() |&gt;\n  mutate(\n    total_savings = sum(ot_reduction_savings),\n    savings_pct_of_total = ot_reduction_savings/total_savings\n    )\n\n\n\n\nCode\novertime_replacement |&gt;\n  group_by(agency) |&gt;\n  summarize(sum(total_ot_worked), sum(full_time_equivalent), \n            savings = round(sum(ot_reduction_savings)), 2) |&gt;\n  arrange(desc(savings))\n\n\nThe table below shows the total overtime hours worked by some agencies over ten years and the number of full-time equivalents required to replace those overtime hours, assuming 1,820 hours per full-time employee. This policy is more effective, as it would have saved more than the possible savings under the salary cap. However, the challenge lies in the significant staffing requirements and the associated costs, which have not yet been accounted for. For example, replacing the 149,075,897.13 overtime hours in the Police Department, we need to hire 81,910 full-time employees.\n\n\n\n\n\n\n\n\nAgency Name\nTotal Overtime Hours Worked\nFull Time Equivalents\n\n\n\n\nPolice Department\n149075897.13\n81910\n\n\nFire Department\n72277786.31\n39713\n\n\nDepartment Of Correction\n43080487.78\n23670\n\n\nDepartment Of Sanitation\n31479058.49\n17296\n\n\nNyc Housing Authority\n26123749.50\n14354\n\n\nDepartment Of Transportation\n12784216.85\n7024\n\n\nDept Of Environment Protection\n8996227.81\n4943\n\n\nHra/Dept Of Social Services.\n13765250.48\n7563\n\n\nAdmin For Children’s Svcs\n10448049.59\n5741\n\n\nDept Of Citywide Admin Svcs\n5578699.05\n3065\n\n\n\n\n\nCode\novertime_replacement |&gt;\n  group_by(agency) |&gt;\n  summarize(total_savings_pct_by_agency = round(sum(savings_pct_of_total), 6)) |&gt;\n  arrange(desc(total_savings_pct_by_agency))\n\n\nRanking the savings by percentage provides a clear understanding of each agency’s contribution and helps optimize hiring decisions. The Police Department could have saved a total of $3,173,931,601, contributing 38%, followed by the Fire Department at 19% and the Department of Correction at 11%.\n\n\n\n\n\n\n\n\nAgency Name\nSavings Contribution\nTotal Savings\n\n\n\n\nPolice Department\n0.38\n3,173,931,601\n\n\nFire Department\n0.19\n1,572,009,614\n\n\nDepartment Of Correction\n0.11\n924,997,078\n\n\nDepartment Of Sanitation\n0.08\n662,883,941\n\n\nNyc Housing Authority\n0.056\n469,262,189\n\n\nDepartment Of Transportation\n0.032\n265,890,485\n\n\nDept Of Environment Protection\n0.025\n206,802,044\n\n\nHra/Dept Of Social Services\n0.025\n204,176,230\n\n\nAdmin For Children’s Svcs\n0.021\n172,298,709\n\n\nDept Of Citywide Admin Svcs\n0.012\n99,898,439\n\n\n\nBased on my findings, I recommend hiring more full-employees to replace overtime hours in the Police Department and the Fire Department. This approach would have saved $4,745,941,215, allowing us to achieve more than half of the potential savings.\n\n\nCreate Your Own Policy Proposal"
  },
  {
    "objectID": "mp01.html#findings",
    "href": "mp01.html#findings",
    "title": "mini project 01",
    "section": "Findings",
    "text": "Findings"
  },
  {
    "objectID": "mp01.html#executive-summary",
    "href": "mp01.html#executive-summary",
    "title": "NYC Payroll Expenses Reduction Proposal",
    "section": "",
    "text": "Managing payroll expenses is a critical component of maintaining the financial health of New York City. With a vast workforce spanning over 160 city agencies, payroll represents a significant portion of the city’s budget. This project aims to assess payroll expenditures and explore strategic measures to enhance cost efficiency. By analyzing historical payroll trends and evaluating targeted policy proposals, we seek to identify opportunities for substantial cost reductions while maintaining essential public services.\n\n\n\nHighest Pay Rate: The chairman of the Civil Service Commission in Manhattan has the highest pay rate, with an hourly rate $566.60.\nHighest Total Payroll: Combining regular and overtime pay, Daniel E Flynn from the Fire Department had the highest total payroll of $521,235.4 in 2021, having worked 1,820 regular hours and 1564.92 overtime hours.\nMost Overtime Worked: William E. Gittens from the Department Of Citywide Admin Services has the most overtime worked, which was 18,564 hours.\nHighest Average Total Annual Payroll Per Employee: The Office of Collective Bargaining has the highest average total annual payrollper employee, at $96,095.94.\nMost Employees on Payroll: The Department of Education has the most employees on the payroll each fiscal year.\nHighest Overtime Usage: The Board of Elections has the highest overtime usage, with total overtime worked accounting for about 20% of the total regular hours.\nAverage Salary for Employees Outside the Five Boroughs: Employees who work outside the five boroughs have an average salary of $91,475.31.\nAggregate Payroll Growth: The city’s aggregate payroll has grown by 35.12% over the past ten fiscal years."
  },
  {
    "objectID": "mp01.html#data-preparation-and-exploratory-data-analysis",
    "href": "mp01.html#data-preparation-and-exploratory-data-analysis",
    "title": "NYC Payroll Expenses Reduction Proposal",
    "section": "Data Preparation and Exploratory Data Analysis",
    "text": "Data Preparation and Exploratory Data Analysis\nLoad Relevant Packages\n\n\nCode\nlibrary(tidyverse)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(DT)\nlibrary(scales)\nlibrary(gt)\n\n\nRead Data in R\n\n\nCode\nnyc_payroll &lt;- read.csv(\"~/STA9750/STA9750-2025-SPRING/data/mp01/nyc_payroll_export.csv\")\n\n\nNow, let’s take a quick look at the payroll data.\n\n\nCode\nglimpse(nyc_payroll)\n\n\n\nConventional Formatting\nConvert the values in some columns to conventional formatting using string_to_title().\nBy using the unique() function in R, we can get a list of distinct values for a variable. I noticed there are some shorthands in the agency_name variable and some agency names need formal formatting.\n\n\nCode\nnyc_payroll &lt;- nyc_payroll |&gt;\n  mutate(\n    agency_name = str_to_title(agency_name),\n    last_name = str_to_title(last_name),\n    first_name = str_to_title(first_name),\n    work_location_borough = str_to_title(work_location_borough),\n    title_description = str_to_title(title_description),\n    leave_status_as_of_june_30 = str_to_title(leave_status_as_of_june_30)\n  )\n\n\n\n\nCode\nnyc_payroll &lt;- nyc_payroll |&gt;\n  mutate(\n    agency_name = case_when(\n      agency_name == \"Bronx Da\" ~ \"Bronx District Attorney\",  \n      agency_name == \"Board Of Correction\" ~ \"Board Of Corrections\",\n      agency_name == \"Dept. Of Design & Construction\" ~ \"Dept Of Design & Construction\",\n      agency_name == \"Dept. Of Homeless Services\" ~ \"Dept Of Homeless Services\",\n      agency_name == \"Office Of Collective Bargainin\" ~ \"Office Of Collective Bargaining\",\n      agency_name == \"Board Of Election\" ~ \"Board Of Elections\",\n      agency_name == \"Doe Custodial Payrol\" ~ \"DOE Custodial Payroll\",\n      TRUE ~ agency_name\n    )\n  )\n\n\nAfter applying some conventional formatting, we can explore the dataset, beginning with the salary history of the NYC Mayor.\nBelow is a table showing the total pay for the current Mayor of New York City. The Mayor of New York City takes office in January, while the fiscal year runs from July to June. As a result, his pay in 2022 was only half of the total annual pay.\n\n\n\n\n\n\nSalary Table for Eric L. Adams\n\n\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(first_name == \"Eric\" & last_name == \"Adams\" & title_description == \"Mayor\") |&gt;\n  mutate(\n    total_salary = regular_gross_paid + total_ot_paid\n  ) |&gt;\n  arrange(fiscal_year)\n\n\n\n\nCode\ntbl_txt &lt;- \"\nFiscal Year, Position, Agency, Total Salary\n2022, Mayor, Office of the Mayor, 120088.4  \n2023, Mayor, Office of the Mayor, 258041.2\n2023, Mayor, Office of the Mayor, 257361.2\n\"\n\nread_csv(tbl_txt) |&gt; \n    mutate(`Total Salary` = dollar(`Total Salary`)) |&gt;\n    datatable(options=list(searching=FALSE, \n                           paging=FALSE,\n                           info=FALSE))\n\n\n\n\n\n\n\n\n\n\nAnalzye the Distribution of base_salary\nIn order to perform payroll analyses, my first step is to examine the distribution of base_salary, which provides pay information for each pay basis. In NYC payroll data set, there are three pay types: per annum/prorated annual, per diem and per hour. For a robust analysis, I used summary() to identify the outliers and inconsistencies and addressed them accordingly.\n\nPer Annum Employees\nThere are some outliers in this category. For example, some observations have a $1 annual rate. After further investigation, I believe these are just not actual payroll records and are immaterial, so I decided no action was needed to handle these values. I applied a 1,820 hours to this group to compute the pay rate.\n\n\nCode\nnyc_payroll |&gt;\n  filter(pay_basis == \"per Annum\") |&gt;\n  select(base_salary) |&gt;\n  summary()\n\n\n\n\nPer Hour Employees\nFrom the output below, it seems unreasonable that the maximum value for an hourly municipal employees was 184,931.45. Upon further investigation, I found that this value comes from the DOE Custodial Payroll, which has only one pay type-an hourly basis. Additionally, half of the records had a per hour rate exceeding $70,000, which suggests the pay is more likely based on an annual salary rather than an hourly rate.\nTo address the inconsistency between the pay basis and the base salary, I defined a reasonable hourly rate range of $100 for this agency. For observations that fell outside this range, I calculated the hourly pay rate using 1,820 hours.\n\n\nCode\nnyc_payroll |&gt;\n  filter(agency_name == \"DOE Custodial Payroll\") |&gt;\n  select(base_salary) |&gt;\n  summary()\n\n\n\n\nCode\nnyc_payroll |&gt;\n  filter(agency_name == \"DOE Custodial Payroll\") |&gt;\n  select(pay_basis) |&gt;\n  unique()\n\n\n\n\nPer Diem Employees\nLet’s explore the subset with pay_basis == per Day. We can see that half of the sample in this category have a base salary per day of less than $33.18. If we are converting the pay to an hourly rate by applying 7.5 hours, it’s likely that some values of base_salary are not consistent with the pay_basis being “per Day”.\nTo address this, I developed complex rules that take into account both regular hours and base salary, ensuring that the hourly pay falls within a reasonable range. For example, for the group of employees who worked over 650 regular hours and had a third quantile base salary of $380.90, I applied 7.5-hour workday to standardize the calculation.\n\n\nCode\nnyc_payroll |&gt;\n  filter(pay_basis == \"per Day\") |&gt;\n  select(\"base_salary\") |&gt;\n  summary()\n\n\n\n\n\nMissing Values\nBe aware that there are over 10,000 missing values in first_name and last_name. Due to confidentiality, some first and last names have been replaced with ‘Xxxx’. For example, approximately 3,541 payroll records in the Police Department having missing names in the data set.\nI decided to exclude these records from the calculations for certain quick-facts related questions later.\n\n\nCode\nprint(any(is.na(nyc_payroll$first_name)))\nprint(any(is.na(nyc_payroll$last_name)))\nprint(sum(is.na(nyc_payroll$first_name)))\nprint(sum(is.na(nyc_payroll$last_name)))"
  },
  {
    "objectID": "mp01.html#policy-analyses",
    "href": "mp01.html#policy-analyses",
    "title": "NYC Payroll Expenses Reduction Proposal",
    "section": "Policy Analyses",
    "text": "Policy Analyses\n\nCapping Salaries at Mayoral Level\nThe first policy is to cap salaries at the Mayoral level. It’s worth noting that Mayor Bloomberg’s salary in 2014 was $1, which was an exception. To ensure a fair analysis, I adjusted it to reflect a standard NYC mayor’s pay.\nFirst, I computed the total mayor pay for each fiscal year and used it as a benchmark to identify the employees whose total compensation exceeded the amount in the same fiscal year. From there, I conducted a salary cap analysis.\n\n\nCode\nbenchmark &lt;- nyc_payroll |&gt;\n  filter(title_description == \"Mayor\") |&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(total_mayor_pay = sum(case_when(\n    fiscal_year == 2014 ~ 2 * total_compensation,\n    TRUE ~ total_compensation)) \n  )\n\nnyc_payroll &lt;- nyc_payroll |&gt;\n  left_join(benchmark, by = \"fiscal_year\") |&gt;\n  rename(salary_cap = total_mayor_pay) |&gt;\n  mutate(\n    is_above_the_cap = ifelse(\n      total_compensation &gt; salary_cap, \"Yes\", \"No\"\n    ),\n    pay_savings_from_cap = ifelse(\n      is_above_the_cap == \"Yes\", round(total_compensation - salary_cap, 2), 0\n    )\n  )\n\n\nBased on my analysis, if the salary cap policy had been implemented, it would have saved a total of $92,359,814 over the past ten fiscal years, as illustrated in Table 1. We can also see that the total savings in 2022 and 2024 are significant; which is consistent with the fact that those years had the highest number of employees whose total compensation exceeds the Mayor’s pay, as shown in chart 1.\nAnd the captains from the Fire Department and the Department of Correction would bear the most brunt of the policy. The savings from the two department would account for about 60%.\n\n\nCode\ntotal_savings_fiscal_year &lt;-nyc_payroll |&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(total_savings = sum(pay_savings_from_cap))\n\ntotal_savings_fiscal_year |&gt;\n  mutate(fiscal_year  = as.character(fiscal_year)) |&gt;\n  bind_rows(tibble(fiscal_year = \"Total\", total_savings = sum(nyc_payroll$pay_savings_from_cap, na.rm = TRUE))) |&gt;\n  gt() |&gt;\n  tab_header(\n    title = md(\"Table 1. Financial Impact of Salary Caps on Payroll Expenses\")\n  ) |&gt;\n  fmt_currency(\n    columns = total_savings,\n    currency = \"USD\"\n  ) |&gt;\n  cols_label(\n    fiscal_year = \"Fiscal Year\",\n    total_savings = \"Projected Payroll Savings\"\n  )\n\n\n\n\n\n\n\n\nTable 1. Financial Impact of Salary Caps on Payroll Expenses\n\n\nFiscal Year\nProjected Payroll Savings\n\n\n\n\n2014\n$285,683.31\n\n\n2015\n$1,417,842.09\n\n\n2016\n$3,282,571.08\n\n\n2017\n$5,026,507.07\n\n\n2018\n$435,666.22\n\n\n2019\n$1,188,031.09\n\n\n2020\n$6,788,684.00\n\n\n2021\n$7,025,046.78\n\n\n2022\n$27,990,701.39\n\n\n2023\n$9,072,817.16\n\n\n2024\n$29,846,263.41\n\n\nTotal\n$92,359,813.60\n\n\n\n\n\n\n\n\n\nCode\nn_employees_exceeding_benchmark &lt;- nyc_payroll |&gt;\n  filter(is_above_the_cap == \"Yes\") |&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(n = n_distinct(full_name))\n\nggplot(n_employees_exceeding_benchmark, aes(x = factor(fiscal_year), y = n)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\", color = \"grey\") +\n  geom_text(aes(label = n), vjust = -0.5, size = 4, color = \"black\")+\n  labs(\n    title = \"Chart 1. Number of Employees by Fiscal Year\",\n    x = \"Fiscal Year\",\n    y = \"Number of Employees\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nIt’s evident that the highest savings come from the Department of Correction, the Fire Department and the Policy Department. Chart 2 illustrates the savings contribution by agency, with these three accounting for a total of 81%.\n\n\nCode\nnyc_payroll |&gt;\n  filter(is_above_the_cap == \"Yes\") |&gt;\n  group_by(agency_name, title_description) |&gt;\n  summarize(est_savings = sum(pay_savings_from_cap)) |&gt;\n  arrange(desc(est_savings), n = 10) |&gt;\n  head(10) |&gt;\n  gt() |&gt;\n  tab_header(\n    title = md(\"Table 2. Top 10 Highest Savings Across Agency and Role\")\n  ) |&gt;\n  fmt_currency(\n    columns = est_savings,\n    currency = \"USD\"\n  ) |&gt;\n  cols_label(\n    agency_name = \"Agency Name\",\n    title_description = \"Title Description\",\n    est_savings = \"Estimated Payroll Savings\"\n  )\n\n\n\n\n\n\n\n\nTable 2. Top 10 Highest Savings Across Agency and Role\n\n\nTitle Description\nEstimated Payroll Savings\n\n\n\n\nDepartment Of Correction\n\n\nCaptain\n$13,433,166.03\n\n\nWarden-Assistant Deputy Warden Ted &lt; 11/1/92\n$6,921,116.26\n\n\nCorrection Officer\n$4,806,111.44\n\n\nSenior Stationary Engineer\n$2,522,180.13\n\n\nFire Department\n\n\nCaptain\n$9,358,012.85\n\n\nPolice Department\n\n\nPolice Officer D/A Detective 1st Gr\n$3,776,058.95\n\n\nLieutenant D/A Commander Of Detective Squad\n$3,412,895.39\n\n\nCaptain Detailed As Assistant Chief Inspector\n$2,850,211.89\n\n\nLieutenant D/A Special Assignment\n$2,731,126.69\n\n\nDept Of Health/Mental Hygiene\n\n\nCity Medical Examiner\n$2,513,273.14\n\n\n\n\n\n\n\n\n\nCode\ntotal_savings_pct_by_agency &lt;- nyc_payroll |&gt;\n  filter(is_above_the_cap == \"Yes\") |&gt;\n  group_by(agency_name) |&gt;\n  summarize(savings_percentage = round(sum(pay_savings_from_cap)/92359814, 2)) |&gt;\n  mutate(\n    agency_name = case_when(\n      savings_percentage &gt; 0.1 ~ agency_name,\n      TRUE ~ \"Others\"\n    )\n  ) |&gt;\n  group_by(agency_name) |&gt;\n  summarize(total_savings_percentage_by_agency = sum(savings_percentage))\n\n\n\n\nCode\ntotal_savings_pct_by_agency &lt;- total_savings_pct_by_agency |&gt;\n  mutate(\n    label = paste(agency_name, scales::percent(total_savings_percentage_by_agency))\n  )\n\nggplot(total_savings_pct_by_agency, aes(x = \"\", y = total_savings_percentage_by_agency, fill = agency_name)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  geom_text(aes(label = label), position = position_stack(vjust = 0.5), color = \"white\", size = 3) +\n  labs(\n    title = \"Chart 2. Total Savings Percentage by Agency\",\n    fill = \"Agency\",\n    caption = \"Source: NYC Payroll Data\"\n  ) +\n  scale_fill_manual(values = c(\n    \"Department Of Correction\" = \"steelblue\",\n    \"Fire Department\" = \"darkorange\",\n    \"Others\" = \"firebrick\",\n    \"Police Department\" = \"darkgreen\"\n    \n  )) +\n  theme(plot.title = element_text(hjust = 0.5),\n        plot.caption = element_text(hjust = 0.5, face = \"italic\", size = 10)\n        )\n\n\n\n\n\n\n\n\n\nHere is something interesting to note in Table 3: If we only consider their base salaries, they are actually below the benchmark. However, since 2015, they have worked an average of 1,300 overtime hours per year, which led to their total compensation exceeding the Mayor’s level.\n\n\nCode\nnyc_payroll |&gt;\n  filter(is_above_the_cap == \"Yes\", agency_name %in% c(\"Department Of Correction\", \"Fire Department\"), \n         title_description == \"Captain\") |&gt;\n  group_by(fiscal_year) |&gt;\n  summarize(avg_ot_hours = mean(ot_hours), avg_base_salary = mean(base_salary)) |&gt;\n  gt() |&gt;\n  tab_header(\n    title = md(\"Table 3. Total Overtime Hours and Base Salary\"), \n    subtitle = \"Two captains from the Fire Department and The Department of Correction \"\n  ) |&gt;\n  fmt_currency(\n    columns = avg_base_salary,\n    currency = \"USD\"\n  ) |&gt;\n  cols_label(\n    fiscal_year = \"Fiscal Year\",\n    avg_ot_hours = \"Average Overtime Hours Worked\",\n    avg_base_salary = \"Average Base Salary\"\n  )\n\n\n\n\n\n\n\n\nTable 3. Total Overtime Hours and Base Salary\n\n\nTwo captains from the Fire Department and The Department of Correction\n\n\nFiscal Year\nAverage Overtime Hours Worked\nAverage Base Salary\n\n\n\n\n2015\n1429.180\n$103,727.50\n\n\n2016\n1525.383\n$101,224.50\n\n\n2017\n1435.201\n$105,414.00\n\n\n2018\n1612.188\n$106,175.00\n\n\n2020\n1549.817\n$113,770.27\n\n\n2021\n1418.045\n$122,421.22\n\n\n2022\n1443.758\n$126,856.89\n\n\n2023\n1301.989\n$127,227.86\n\n\n2024\n1154.149\n$138,945.35\n\n\n\n\n\n\n\nIn conclusion, I do not recommend implementing a salary cap policy as I do not believe it will be effective. The reason is that very few employees have a base salary exceeding the Mayor’s salary.\nEven if we cap their salaries, those entitled to overtime pay would likely nullify the policy’s impact. For instance, the captain in the Department of Correction and the captain in the Fire Department had total compensation exceeding the Mayor’s salary. However, their base salaries were only half of the Mayor’s. It was their overtime earnings that pushed their total pay above the benchmark.\nTherefore, I do not believe a salary cap would be an effective solution.\n\n\nIncreasing Staffing to Reduce Overtime Expenses\nTo explore the the impact and savings by increasing staffing to reduce overtime hours. First, I aggregated the total overtime hours for each combination of agency and job title and calculated the number of full-time employee equivalents using a standard of 1,820 hours per full-time employee. Using the average pay rate for each combination of agency and position, I then computed the potential full-time salary if overtime hours were replaced by equivalent full-time positions.\nFrom my analyses, we can see that replacing overtime hours with full-time employees would have resulted in total savings of $8,293,349,444 over the past ten fiscal years. This policy proves to be more effective in generating savings than the salary cap.\nAs previously mentioned, there are actually very few municipal employees whose base salaries exceed the Mayor’s salary. The main reason their total compensation surpasses this level is the significant amount of overtime worked.\nIn addition, we can see that a 50% savings can be achieved from increasing the number of full-time employees to reduce overtime hours, particularly in the Police Department and the Fire Department.\nTable 4 shows the total overtime hours worked by some agencies over ten years and the number of full-time equivalents required to replace those overtime hours, assuming 1,820 hours per full-time employee. This policy is more effective, as it would have saved more than the possible savings under the salary cap. However, the challenge lies in the significant staffing requirements and the associated costs, which have not yet been accounted for. For example, replacing the 149,075,897 overtime hours in the Police Department, we need to hire 81,910 full-time employees.\n\n\nCode\novertime_replacement &lt;- nyc_payroll |&gt;\n  mutate(agency_role = paste(agency_name, title_description, sep = \"_\")) |&gt;\n  group_by(fiscal_year, agency_role) |&gt;\n  summarize(avg_pay_rate = mean(pay_rate), total_ot_worked = sum(ot_hours)) |&gt;\n  filter(total_ot_worked &gt; 0) |&gt;\n  mutate(\n    full_time_equivalent = round(total_ot_worked/1820, 6),\n    full_time_pay = round(avg_pay_rate * full_time_equivalent * 1820, 2),\n    ot_reduction_savings = total_ot_worked * 1.5 * avg_pay_rate - full_time_pay,\n    agency = str_extract(agency_role, \"^[^_]+\")\n  ) |&gt;\n  ungroup() |&gt;\n  mutate(\n    total_savings = sum(ot_reduction_savings),\n    savings_pct_of_total = ot_reduction_savings/total_savings\n    )\n\n\n\n\nCode\ndf_overtime &lt;- overtime_replacement |&gt;\n  group_by(agency) |&gt;\n  summarize(total_ot = sum(total_ot_worked), \n            full_time_equivalents = round(sum(full_time_equivalent), 0), \n            payroll_savings = sum(ot_reduction_savings)) |&gt;\n  arrange(desc(total_ot)) |&gt;\n  head(10)\n\ndf_overtime |&gt;\n  select(\"agency\", \"total_ot\", \"full_time_equivalents\") |&gt;\n  gt() |&gt;\n  tab_header(\n    title = md(\"Table 4. Overtime Hours and Full Time Equivalents by Agency\"),\n    subtitle = \"Top 10 Agencies with the Highest Overtime Hours and Their Full-Time Equivalents\"\n  ) |&gt;\n  cols_label(\n    agency = \"Agency Name\",\n    total_ot = \"Total Overtime Hours Worked\",\n    full_time_equivalents = \"Full-Time Equivalents\"\n  )\n\n\n\n\n\n\n\n\nTable 4. Overtime Hours and Full Time Equivalents by Agency\n\n\nTop 10 Agencies with the Highest Overtime Hours and Their Full-Time Equivalents\n\n\nAgency Name\nTotal Overtime Hours Worked\nFull-Time Equivalents\n\n\n\n\nPolice Department\n149075897\n81910\n\n\nFire Department\n72277786\n39713\n\n\nDepartment Of Correction\n43080488\n23671\n\n\nDepartment Of Sanitation\n31479058\n17296\n\n\nNyc Housing Authority\n26123750\n14354\n\n\nHra/Dept Of Social Services\n13765250\n7563\n\n\nDepartment Of Transportation\n12784217\n7024\n\n\nAdmin For Children's Svcs\n10448050\n5741\n\n\nDept Of Environment Protection\n8996228\n4943\n\n\nDept Of Parks & Recreation\n5899887\n3242\n\n\n\n\n\n\n\nRanking the savings by percentage provides a clear understanding of each agency’s contribution and helps optimize hiring decisions. The Police Department could have saved a total of $3,173,931,601, contributing 38%, followed by the Fire Department at 19% and the Department of Correction at 11%.\n\n\nCode\novertime_replacement |&gt;\n  group_by(agency) |&gt;\n  summarize(est_total_savings = round(sum(ot_reduction_savings), 0),\n            total_savings_pct = round(sum(savings_pct_of_total), 6)) |&gt;\n  mutate(\n    agency_name = case_when(\n      total_savings_pct &gt;= 0.01 ~ agency,\n      TRUE ~ \"Others\"\n    )\n  ) |&gt;\n  group_by(agency_name) |&gt;\n  summarize(\n    total_savings = sum(est_total_savings),\n    savings_contribution = round(sum(total_savings_pct), 2)\n  ) |&gt;\n  arrange(desc(savings_contribution)) |&gt;\n  gt() |&gt;\n  tab_header(\n    title = md(\"Table 5. Financial Impact of Overtime Reduction and Full-Time Replacements\")\n  ) |&gt;\n  fmt_currency(\n    columns = total_savings,\n    currency = \"USD\"\n  ) |&gt;\n  fmt_percent(\n    columns = savings_contribution,\n    scale_values = TRUE,\n    decimals = 0\n  ) |&gt;\n  cols_label(\n    agency_name = \"Agency Name\",\n    total_savings = \"Total Estimated Savings\",\n    savings_contribution = \"Savings Contribution\"\n  )\n\n\n\n\n\n\n\n\nTable 5. Financial Impact of Overtime Reduction and Full-Time Replacements\n\n\nAgency Name\nTotal Estimated Savings\nSavings Contribution\n\n\n\n\nPolice Department\n$3,173,931,601.00\n38%\n\n\nFire Department\n$1,572,009,614.00\n19%\n\n\nDepartment Of Correction\n$924,997,078.00\n11%\n\n\nDepartment Of Sanitation\n$662,883,941.00\n8%\n\n\nNyc Housing Authority\n$469,262,189.00\n6%\n\n\nOthers\n$451,159,542.00\n5%\n\n\nDepartment Of Transportation\n$265,890,485.00\n3%\n\n\nAdmin For Children's Svcs\n$172,298,709.00\n2%\n\n\nDept Of Environment Protection\n$206,802,044.00\n2%\n\n\nHra/Dept Of Social Services\n$204,176,230.00\n2%\n\n\nDept Of Citywide Admin Svcs\n$99,898,439.00\n1%\n\n\nDept Of Parks & Recreation\n$90,039,571.00\n1%\n\n\n\n\n\n\n\nBased on my findings, I recommend hiring more full-employees to replace overtime hours in the Police Department and the Fire Department. This approach would have saved $4,745,941,215, allowing us to achieve more than half of the potential savings.\n\n\nMy Own Policy Proposal\nOne of the challenges of replacing overtime hours with full-time employees is that some positions require highly specialized skills. In such cases, implementing a salary cap could risk lowering the quality of services provided to the public.\nMy proposal is to ensure employees are compensated fairly while also equipping them with the necessary resources and training to enhance efficiency. Rather than focusing solely on salary caps, we can establish an upper limit on overtime hours. By capping overtime, we can not only improve productivity but also reduce overall payroll expenses."
  }
]